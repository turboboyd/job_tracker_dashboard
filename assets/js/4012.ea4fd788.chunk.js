"use strict";(self.webpackChunkjob_tracker_dashboard=self.webpackChunkjob_tracker_dashboard||[]).push([[4012],{338(e,o,l){function a(e,o,l,a={replace:!0}){const t=new URLSearchParams(o.search);for(const[e,o]of Object.entries(l))null!=o&&!1!==o?!0!==o?t.set(e,String(o)):t.set(e,"1"):t.delete(e);const s=t.toString();e({pathname:o.pathname,search:s?`?${s}`:""},{replace:a.replace??!0})}l.d(o,{N:()=>a})},15019(e,o,l){l.d(o,{_H:()=>f,Xk:()=>b,g5:()=>p,$V:()=>x,LC:()=>g});var a=l(24589),t=l(80784),s=l(57616),r=l(42472);function n(e){return e instanceof Error?e.message:String(e)}function d(e){return{error:{message:e}}}function i(){return{iso:(new Date).toISOString(),server:(0,a.O5)()}}function c(e){const o=String(e??"").trim();return o?/^https?:\/\//i.test(o)?o:`https://${o}`:""}const u=s.q.injectEndpoints({endpoints:e=>({getAllMatches:e.query({async queryFn(e,o){try{const e=(0,r.j)(o.getState()),l=(0,a.P)((0,t.A9)(e),(0,a.My)("matchedAt","desc"));return{data:(await(0,a.GG)(l)).docs.map(e=>({id:e.id,...e.data()}))}}catch(e){return d(n(e))}},providesTags:e=>e?[...e.map(e=>({type:"LoopMatches",id:e.id})),{type:"LoopMatches",id:"LIST:ALL"}]:[{type:"LoopMatches",id:"LIST:ALL"}]}),getMatchesByLoop:e.query({async queryFn({loopId:e},o){try{const l=(0,r.j)(o.getState()),s=(0,a.P)((0,t.A9)(l),(0,a._M)("loopId","==",e),(0,a.My)("matchedAt","desc"));return{data:(await(0,a.GG)(s)).docs.map(e=>({id:e.id,...e.data()}))}}catch(e){return d(n(e))}},providesTags:(e,o,l)=>[{type:"LoopMatches",id:`LIST:LOOP:${l.loopId}`}]}),getMatch:e.query({async queryFn({matchId:e},o){try{const l=(0,r.j)(o.getState()),s=await(0,a.x7)((0,t.hM)(l,e));return s.exists()?{data:{id:s.id,...s.data()}}:{data:null}}catch(e){return d(n(e))}},providesTags:(e,o,l)=>[{type:"LoopMatches",id:l.matchId}]}),createMatch:e.mutation({async queryFn(e,o){try{const l=(0,r.j)(o.getState()),{iso:s,server:n}=i(),d={...e,url:c(e.url),createdAt:s,updatedAt:s,createdAtTs:n,updatedAtTs:n};return{data:{id:(await(0,a.gS)((0,t.A9)(l),d)).id}}}catch(e){return d(n(e))}},invalidatesTags:(e,o,l)=>[{type:"LoopMatches",id:"LIST:ALL"},{type:"LoopMatches",id:`LIST:LOOP:${l.loopId}`}]}),updateMatchStatus:e.mutation({async queryFn({matchId:e,status:o},l){try{const{iso:s,server:n}=i(),d=(0,r.j)(l.getState());return await(0,a.mZ)((0,t.hM)(d,e),{status:o,updatedAt:s,updatedAtTs:n}),{data:void 0}}catch(e){return d(n(e))}},invalidatesTags:(e,o,l)=>[{type:"LoopMatches",id:l.matchId},{type:"LoopMatches",id:"LIST:ALL"},{type:"LoopMatches",id:`LIST:LOOP:${l.loopId}`}]}),updateMatch:e.mutation({async queryFn({matchId:e,patch:o},l){try{const{iso:s,server:n}=i(),d=function(e){const o={...e};return"string"==typeof o.url&&(o.url=c(o.url)),o}(o),u=(0,r.j)(l.getState());return await(0,a.mZ)((0,t.hM)(u,e),{...d,updatedAt:s,updatedAtTs:n}),{data:void 0}}catch(e){return d(n(e))}},invalidatesTags:(e,o,l)=>[{type:"LoopMatches",id:l.matchId},{type:"LoopMatches",id:"LIST:ALL"}]}),deleteMatch:e.mutation({async queryFn({matchId:e},o){try{const l=(0,r.j)(o.getState());return await(0,a.kd)((0,t.hM)(l,e)),{data:void 0}}catch(e){return d(n(e))}},invalidatesTags:(e,o,l)=>[{type:"LoopMatches",id:l.matchId},{type:"LoopMatches",id:"LIST:ALL"},{type:"LoopMatches",id:`LIST:LOOP:${l.loopId}`}]})})}),{useGetAllMatchesQuery:p,useGetMatchesByLoopQuery:m,useGetMatchQuery:h,useCreateMatchMutation:f,useUpdateMatchStatusMutation:g,useUpdateMatchMutation:x,useDeleteMatchMutation:b}=u;l(65546)},24012(e,o,l){l.r(o),l.d(o,{default:()=>Z});var a=l(22022),t=l(3433),s=l(20410),r=l(68701),n=l(96540),d=l(74848);function i({title:e,subtitle:o,right:l}){return(0,d.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("div",{className:"text-2xl font-semibold text-foreground",children:e}),o?(0,d.jsx)("div",{className:"mt-1 text-sm text-muted-foreground",children:o}):null]}),l]})}function c({children:e}){return(0,d.jsx)("div",{className:"rounded-2xl border border-border bg-card p-6 text-sm text-muted-foreground",children:e})}var u=l(43578),p=l(14603),m=l(82284);function h(e){return"object"==typeof e&&null!==e}function f(e,o){return"string"==typeof e?e:o}function g(e,o){const l="number"==typeof e?e:Number(e);return Number.isFinite(l)?l:o}function x(e,o,l){return o.includes(e)?e:l}function b(e){return e.map(e=>String(e??"").trim()).filter(Boolean).join(" OR ")}l(56258);var v=l(99653),y=l(95531),j=l(7425),w=l(12664),N=l(15019),M=l(82207);const k=[{needle:"linkedin.com",platform:"linkedin"},{needle:"indeed.",platform:"indeed"},{needle:"glassdoor.",platform:"glassdoor"},{needle:"monster.",platform:"monster"},{needle:"stepstone.",platform:"stepstone"},{needle:"xing.",platform:"xing"},{needle:"github.com",platform:"github"},{needle:"wellfound.",platform:"wellfound"},{needle:"angel.co",platform:"wellfound"},{needle:"levels.fyi",platform:"levels"}];var L=l(95310);const C=L.WI.map(e=>e.value),S=L.YN.map(e=>e.value);function B({open:e,onOpenChange:o,loopId:l,defaultPlatform:t}){const{t:s}=(0,a.Bd)(),[i,c]=(0,N._H)(),u=(0,n.useMemo)(()=>function(e){return w.Ik({title:w.Yj().trim().min(2,e("loops.validation.titleRequired",{defaultValue:"Title is required"})).required(e("loops.validation.titleRequired",{defaultValue:"Title is required"})),company:w.Yj().trim().min(2,e("loops.validation.companyRequired",{defaultValue:"Company is required"})).required(e("loops.validation.companyRequired",{defaultValue:"Company is required"})),location:w.Yj().trim().min(2,e("loops.validation.locationRequired",{defaultValue:"Location is required"})).required(e("loops.validation.locationRequired",{defaultValue:"Location is required"})),platform:w.gl().oneOf(C).required(e("loops.validation.platformRequired",{defaultValue:"Platform is required"})),url:w.Yj().trim().required(e("loops.validation.urlRequired",{defaultValue:"Job URL is required"})).test("is-url",e("loops.validation.invalidUrl",{defaultValue:"Invalid URL"}),e=>Boolean(function(e){const o=e.trim();if(!o)return null;try{return new URL(o)}catch{try{return new URL(`https://${o}`)}catch{return null}}}(e??""))),description:w.Yj().trim().min(1,e("loops.validation.descriptionRequired",{defaultValue:"Description is required"})).required(e("loops.validation.descriptionRequired",{defaultValue:"Description is required"})),status:w.gl().oneOf(S).required(e("loops.validation.statusRequired",{defaultValue:"Status is required"})),matchedAt:w.Yj().trim().required()})}(s),[s]),p=(0,n.useMemo)(()=>{return{title:"",company:"",location:"",platform:(e=t,e??"linkedin"),url:"",description:"",status:"new",matchedAt:(new Date).toISOString()};var e},[t]),m=c.isLoading;return(0,d.jsx)(r.aF,{open:e,onOpenChange:o,title:s("loops.addMatch",{defaultValue:"Add match"}),description:s("loops.addMatchDescription",{defaultValue:"Paste the job URL and fill details. This saves a match to your loop."}),children:(0,d.jsx)(j.l1,{initialValues:p,enableReinitialize:!0,validationSchema:u,onSubmit:async(e,a)=>{a.setStatus(void 0);try{await i({loopId:l,title:e.title,company:e.company,location:e.location,platform:e.platform,url:e.url,description:e.description,status:e.status,matchedAt:e.matchedAt}).unwrap(),o(!1)}catch(e){a.setStatus((0,v.u1)(e)||s("loops.failedToSaveMatch",{defaultValue:"Failed to save match"}))}},children:e=>{const l=("string"==typeof e.status?e.status:void 0)||(c.isError?(0,v.u1)(c.error):void 0),a=!m&&e.dirty;return(0,d.jsxs)("form",{onSubmit:e.handleSubmit,className:"space-y-4",children:[l?(0,d.jsx)(r.Wz,{message:l}):null,(0,d.jsxs)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[(0,d.jsx)(M.z,{label:s("loops.jobTitle",{defaultValue:"Job title"}),required:!0,error:e.touched.title?e.errors.title:void 0,children:({id:o,describedBy:l,invalid:a})=>(0,d.jsx)(r.pd,{id:o,name:"title",value:e.values.title,onChange:e.handleChange,onBlur:e.handleBlur,placeholder:s("loops.jobTitlePlaceholder",{defaultValue:"Frontend Developer"}),state:a?"error":"default","aria-invalid":a,"aria-describedby":l,disabled:m})}),(0,d.jsx)(M.z,{label:s("loops.company",{defaultValue:"Company"}),required:!0,error:e.touched.company?e.errors.company:void 0,children:({id:o,describedBy:l,invalid:a})=>(0,d.jsx)(r.pd,{id:o,name:"company",value:e.values.company,onChange:e.handleChange,onBlur:e.handleBlur,placeholder:s("loops.companyPlaceholder",{defaultValue:"Acme GmbH"}),state:a?"error":"default","aria-invalid":a,"aria-describedby":l,disabled:m})}),(0,d.jsx)(M.z,{label:s("loops.location",{defaultValue:"Location"}),required:!0,error:e.touched.location?e.errors.location:void 0,children:({id:o,describedBy:l,invalid:a})=>(0,d.jsx)(r.pd,{id:o,name:"location",value:e.values.location,onChange:e.handleChange,onBlur:e.handleBlur,placeholder:s("loops.locationJobPlaceholder",{defaultValue:"Berlin / Remote"}),state:a?"error":"default","aria-invalid":a,"aria-describedby":l,disabled:m})}),(0,d.jsx)(M.z,{label:s("loops.platform",{defaultValue:"Platform"}),required:!0,children:({id:o,describedBy:l})=>(0,d.jsx)("select",{id:o,name:"platform",value:e.values.platform,onChange:e.handleChange,onBlur:e.handleBlur,"aria-describedby":l,disabled:m,className:"h-10 w-full rounded-xl border border-border bg-input px-3 text-sm text-foreground",children:L.WI.map(e=>(0,d.jsx)("option",{value:e.value,children:e.label},e.value))})}),(0,d.jsx)(M.z,{label:s("loops.jobUrl",{defaultValue:"Job URL"}),required:!0,hint:s("loops.jobUrlHint",{defaultValue:"You can paste without https:// (it will be normalized on save)."}),error:e.touched.url?e.errors.url:void 0,children:({id:o,describedBy:l,invalid:a})=>(0,d.jsx)(r.pd,{id:o,name:"url",value:e.values.url,onChange:o=>{const l=o.target.value;e.setFieldValue("url",l);const a=function(e){if(!e)return"other";let o="";try{o=new URL(e).host.toLowerCase()}catch{return"other"}for(const e of k)if(o.includes(e.needle))return e.platform;return"other"}(l);a&&e.setFieldValue("platform",a)},onBlur:e.handleBlur,placeholder:s("loops.jobUrlPlaceholder",{defaultValue:"company.com/job"}),state:a?"error":"default","aria-invalid":a,"aria-describedby":l,disabled:m})}),(0,d.jsx)(M.z,{label:s("loops.status",{defaultValue:"Status"}),required:!0,children:({id:o,describedBy:l})=>(0,d.jsx)("select",{id:o,name:"status",value:e.values.status,onChange:e.handleChange,onBlur:e.handleBlur,"aria-describedby":l,disabled:m,className:"h-10 w-full rounded-xl border border-border bg-input px-3 text-sm text-foreground",children:L.YN.map(e=>(0,d.jsx)("option",{value:e.value,children:s(`loops.status.${e.value}`,{defaultValue:e.label})},e.value))})})]}),(0,d.jsx)(M.z,{label:s("loops.description",{defaultValue:"Description"}),required:!0,error:e.touched.description?e.errors.description:void 0,children:({id:o,describedBy:l,invalid:a})=>(0,d.jsx)(r.fs,{id:o,name:"description",value:e.values.description,onChange:e.handleChange,onBlur:e.handleBlur,placeholder:s("loops.descriptionPlaceholder",{defaultValue:"Paste key parts of the job description here…"}),state:a?"error":"default","aria-invalid":a,"aria-describedby":l,disabled:m})}),(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)(r.$n,{type:"submit",variant:"default",shadow:"sm",shape:"lg",disabled:!a,children:m?s("loops.saving",{defaultValue:"Saving..."}):s("loops.saveMatch",{defaultValue:"Save match"})}),(0,d.jsx)(r.$n,{type:"button",variant:"outline",shape:"lg",onClick:()=>o(!1),disabled:m,children:s("loops.cancel",{defaultValue:"Cancel"})})]})]})}})})}function A(e){const o=new Set;for(const l of e)o.add(l);return Array.from(o)}function I({open:e,onOpenChange:o,value:l,disabled:t,onSave:s}){const{t:i}=(0,a.Bd)(),[c,u]=(0,n.useState)(()=>A(l??[])),[p,h]=(0,n.useState)(!1);(0,n.useEffect)(()=>{e&&u(A(l??[]))},[e,l]);const f=(0,n.useMemo)(()=>new Set(c),[c]),g=c.length,x=!t&&!p;return(0,d.jsx)(r.aF,{open:e,onOpenChange:o,title:i("loops.editSources","Edit sources"),description:i("loops.editSourcesDescription","Choose job boards/platforms. This controls which search links are generated."),size:"lg",children:(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[(0,d.jsxs)("div",{className:"text-sm text-muted-foreground",children:[i("loops.selected","Selected"),": "," ",(0,d.jsx)("span",{className:"font-medium text-foreground",children:g})]}),(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)(r.$n,{variant:"outline",shape:"lg",onClick:()=>u(m.Rx),disabled:t||p,children:i("loops.recommended","Recommended")}),(0,d.jsx)(r.$n,{variant:"outline",shape:"lg",onClick:()=>u(m.VT),disabled:t||p,children:i("loops.selectAll","Select all")})]})]}),(0,d.jsxs)("div",{className:"rounded-2xl border border-border bg-background p-4 space-y-3",children:[(0,d.jsx)("div",{className:"text-sm font-semibold text-foreground",children:i("loops.groups","Groups")}),(0,d.jsx)("div",{className:"flex flex-wrap gap-2",children:m.fd.map(e=>{const o=(0,m.zV)(e.id),l=o.filter(e=>f.has(e)).length,a=l===o.length&&o.length>0;return(0,d.jsxs)("button",{type:"button",onClick:()=>(e=>{const o=(0,m.zV)(e);u(e=>{const l=new Set(e);if(o.every(e=>l.has(e)))for(const e of o)l.delete(e);else for(const e of o)l.add(e);return Array.from(l)})})(e.id),disabled:t||p,className:["inline-flex items-center gap-2 rounded-full border px-3 py-1 text-xs transition-colors",a?"border-primary/50 bg-primary/10 text-foreground":"border-border bg-card text-muted-foreground",t||p?"opacity-50 cursor-not-allowed":"hover:bg-muted/40"].join(" "),children:[(0,d.jsx)("span",{className:"font-medium",children:e.title}),(0,d.jsxs)("span",{className:"text-[11px] text-muted-foreground",children:[l,"/",o.length]})]},e.id)})})]}),(0,d.jsxs)("div",{className:"rounded-2xl border border-border bg-background p-4 space-y-3",children:[(0,d.jsx)("div",{className:"text-sm font-semibold text-foreground",children:i("loops.platforms","Platforms")}),(0,d.jsx)("div",{className:"grid grid-cols-1 gap-2 md:grid-cols-2",children:(b=m.VT,[...b].sort((e,o)=>{const l=m.Jf[e]??e,a=m.Jf[o]??o;return l.localeCompare(a)})).map(e=>{const o=f.has(e),l=m.Jf[e]??e;return(0,d.jsxs)("label",{className:["flex items-center gap-3 rounded-xl border px-3 py-2 text-sm",o?"border-primary/40 bg-primary/5":"border-border bg-card",t||p?"opacity-50 cursor-not-allowed":"hover:bg-muted/30"].join(" "),children:[(0,d.jsx)("input",{type:"checkbox",checked:o,onChange:()=>(e=>{u(o=>{const l=new Set(o);return l.has(e)?l.delete(e):l.add(e),Array.from(l)})})(e),disabled:t||p}),(0,d.jsx)("span",{className:"text-foreground",children:l})]},e)})})]}),(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)(r.$n,{variant:"default",shadow:"sm",shape:"lg",onClick:async function(){h(!0);try{await s(A(c)),o(!1)}finally{h(!1)}},disabled:!x,children:p?i("loops.saving","Saving..."):i("loops.save","Save")}),(0,d.jsx)(r.$n,{variant:"outline",shape:"lg",onClick:()=>o(!1),disabled:t||p,children:i("loops.cancel","Cancel")})]})]})});var b}const V=[5,10,20,30,50,100],R=[1,3,7,14,30];function q(e){return e.replace(/\s+/g," ").trim()}function T({value:e,onChange:o,onApply:l,onReset:t,disabled:s}){const{t:i}=(0,a.Bd)(),[c,u]=(0,n.useState)(!1),p=(0,n.useMemo)(()=>[{value:"any",label:i("loops.workMode.any","Any")},{value:"onsite",label:i("loops.workMode.onsite","On-site")},{value:"hybrid",label:i("loops.workMode.hybrid","Hybrid")},{value:"remote",label:i("loops.workMode.remote","Remote")},{value:"remote_only",label:i("loops.workMode.remoteOnly","Remote-only")}],[i]),m=(0,n.useMemo)(()=>[{value:"intern",label:i("loops.seniority.intern","Intern")},{value:"junior",label:i("loops.seniority.junior","Junior")},{value:"mid",label:i("loops.seniority.mid","Mid")},{value:"senior",label:i("loops.seniority.senior","Senior")},{value:"lead",label:i("loops.seniority.lead","Lead")}],[i]),h=(0,n.useMemo)(()=>[{value:"full_time",label:i("loops.employment.fullTime","Full-time")},{value:"part_time",label:i("loops.employment.partTime","Part-time")},{value:"contract",label:i("loops.employment.contract","Contract")},{value:"internship",label:i("loops.employment.internship","Internship")},{value:"ausbildung",label:i("loops.employment.ausbildung","Ausbildung")}],[i]),f=(0,n.useMemo)(()=>[{value:"any",label:i("loops.language.any","Any")},{value:"de",label:i("loops.language.de","DE")},{value:"en",label:i("loops.language.en","EN")}],[i]),g=(0,n.useMemo)(()=>{const o=[],l=e.role.trim(),a=e.location.trim();return l&&o.push(i("loops.badgeRole","Role: {{value}}",{value:l})),a&&o.push(i("loops.badgeLoc","Loc: {{value}}",{value:a})),o.push(i("loops.badgeRadius","Radius: {{value}}km",{value:e.radiusKm})),"any"!==e.workMode&&o.push(i("loops.badgeMode","Mode: {{value}}",{value:e.workMode})),o.push(i("loops.badgePosted","Posted: {{value}}d",{value:e.postedWithin})),o},[i,e]);return(0,d.jsxs)("div",{className:"rounded-2xl border border-border bg-card p-6 space-y-4",children:[(0,d.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("div",{className:"text-base font-semibold text-foreground",children:i("loops.filtersTitle","Filters")}),(0,d.jsx)("div",{className:"mt-1 text-sm text-muted-foreground",children:i("loops.filtersSubtitle","Update → Apply → links refresh & saved to loop.")}),g.length?(0,d.jsx)("div",{className:"mt-2 flex flex-wrap gap-2",children:g.map(e=>(0,d.jsx)("span",{className:"rounded-full border border-border bg-background px-3 py-1 text-xs text-muted-foreground",children:e},e))}):null]}),(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)(r.$n,{variant:"default",shadow:"sm",shape:"lg",onClick:l,disabled:s,children:i("loops.apply","Apply")}),(0,d.jsx)(r.$n,{variant:"outline",shape:"lg",onClick:t,disabled:s,children:i("loops.reset","Reset")})]})]}),(0,d.jsxs)("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-12",children:[(0,d.jsx)("div",{className:"md:col-span-5",children:(0,d.jsx)(r.zB,{label:i("loops.professionRole","Profession / Role"),children:(0,d.jsx)(r.pd,{value:e.role,onChange:l=>o({...e,role:l.target.value}),placeholder:i("loops.professionRolePlaceholder","Fachinformatiker OR React Developer"),disabled:s})})}),(0,d.jsx)("div",{className:"md:col-span-4",children:(0,d.jsx)(r.zB,{label:i("loops.location","Location"),children:(0,d.jsx)(r.pd,{value:e.location,onChange:l=>o({...e,location:l.target.value}),placeholder:i("loops.locationPlaceholder","Berlin"),disabled:s})})}),(0,d.jsx)("div",{className:"md:col-span-2",children:(0,d.jsx)(r.zB,{label:i("loops.radius","Radius"),children:(0,d.jsx)("select",{value:e.radiusKm,onChange:l=>o({...e,radiusKm:Number(l.target.value)}),className:"h-10 w-full rounded-xl border border-border bg-input px-3 text-sm text-foreground",disabled:s,children:V.map(e=>(0,d.jsx)("option",{value:e,children:i("loops.km","{{value}} km",{value:e})},e))})})}),(0,d.jsx)("div",{className:"md:col-span-1",children:(0,d.jsx)(r.zB,{label:" ",hint:"",children:(0,d.jsx)(r.$n,{variant:"outline",shape:"lg",className:"w-full",onClick:()=>u(e=>!e),disabled:s,children:c?i("loops.less","Less"):i("loops.more","More")})})})]}),c?(0,d.jsxs)("div",{className:"rounded-2xl border border-border bg-background p-4 space-y-4",children:[(0,d.jsxs)("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-12",children:[(0,d.jsx)("div",{className:"md:col-span-3",children:(0,d.jsx)(r.zB,{label:i("loops.workModeTitle","Work mode"),children:(0,d.jsx)("select",{value:e.workMode,onChange:l=>o({...e,workMode:l.target.value}),className:"h-10 w-full rounded-xl border border-border bg-card px-3 text-sm text-foreground",disabled:s,children:p.map(e=>(0,d.jsx)("option",{value:e.value,children:e.label},e.value))})})}),(0,d.jsx)("div",{className:"md:col-span-3",children:(0,d.jsx)(r.zB,{label:i("loops.seniorityTitle","Seniority"),children:(0,d.jsx)("select",{value:e.seniority,onChange:l=>o({...e,seniority:l.target.value}),className:"h-10 w-full rounded-xl border border-border bg-card px-3 text-sm text-foreground",disabled:s,children:m.map(e=>(0,d.jsx)("option",{value:e.value,children:e.label},e.value))})})}),(0,d.jsx)("div",{className:"md:col-span-3",children:(0,d.jsx)(r.zB,{label:i("loops.employmentType","Employment type"),children:(0,d.jsx)("select",{value:e.employmentType,onChange:l=>o({...e,employmentType:l.target.value}),className:"h-10 w-full rounded-xl border border-border bg-card px-3 text-sm text-foreground",disabled:s,children:h.map(e=>(0,d.jsx)("option",{value:e.value,children:e.label},e.value))})})}),(0,d.jsx)("div",{className:"md:col-span-3",children:(0,d.jsx)(r.zB,{label:i("loops.postedWithin","Posted within"),children:(0,d.jsx)("select",{value:e.postedWithin,onChange:l=>o({...e,postedWithin:Number(l.target.value)}),className:"h-10 w-full rounded-xl border border-border bg-card px-3 text-sm text-foreground",disabled:s,children:R.map(e=>(0,d.jsx)("option",{value:e,children:i("loops.days","{{value}} days",{value:e})},e))})})})]}),(0,d.jsxs)("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-12",children:[(0,d.jsx)("div",{className:"md:col-span-6",children:(0,d.jsx)(r.zB,{label:i("loops.includeKeywords","Include keywords"),hint:i("loops.includeKeywordsHint","Optional, will be appended to search query"),children:(0,d.jsx)(r.pd,{value:e.includeKeywords,onChange:l=>o({...e,includeKeywords:q(l.target.value)}),placeholder:i("loops.includeKeywordsPlaceholder","react typescript next"),disabled:s})})}),(0,d.jsx)("div",{className:"md:col-span-6",children:(0,d.jsx)(r.zB,{label:i("loops.excludeKeywords","Exclude keywords"),hint:i("loops.excludeKeywordsHint","Optional, will be appended as exclusions"),children:(0,d.jsx)(r.pd,{value:e.excludeKeywords,onChange:l=>o({...e,excludeKeywords:q(l.target.value)}),placeholder:i("loops.excludeKeywordsPlaceholder","senior lead manager zeitarbeit"),disabled:s})})})]}),(0,d.jsxs)("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-12",children:[(0,d.jsx)("div",{className:"md:col-span-3",children:(0,d.jsx)(r.zB,{label:i("loops.languageTitle","Language"),children:(0,d.jsx)("select",{value:e.language,onChange:l=>o({...e,language:l.target.value}),className:"h-10 w-full rounded-xl border border-border bg-card px-3 text-sm text-foreground",disabled:s,children:f.map(e=>(0,d.jsx)("option",{value:e.value,children:e.label},e.value))})})}),(0,d.jsx)("div",{className:"md:col-span-4 flex items-end",children:(0,d.jsxs)("label",{className:"flex items-center gap-2 text-sm text-foreground",children:[(0,d.jsx)("input",{type:"checkbox",checked:e.excludeAgencies,onChange:l=>o({...e,excludeAgencies:l.target.checked}),disabled:s}),i("loops.excludeAgencies","Exclude agencies / Zeitarbeit")]})}),(0,d.jsx)("div",{className:"md:col-span-5"})]}),(0,d.jsx)("div",{className:"text-xs text-muted-foreground",children:i("loops.advancedInfo","Advanced filters are stored in loop.filters. URL builders can be extended later per platform.")})]}):null]})}function P({open:e,onOpenChange:o,value:l,onChange:t,onApply:s,onReset:n,disabled:i}){const{t:c}=(0,a.Bd)();return(0,d.jsx)(r.aF,{open:e,onOpenChange:o,title:c("loops.myLoopSettings","My Loop settings"),description:c("loops.myLoopSettingsDescription","Update filters, click Apply to refresh links and save settings to your loop."),size:"lg",children:(0,d.jsx)(T,{value:l,onChange:t,onApply:s,onReset:n,disabled:i})})}var $=l(61239);function O({platform:e,url:o,isActive:l,onOpen:t,onAdd:s,addDisabled:n}){const{t:i}=(0,a.Bd)(),c=$.Jf[e]??e;return(0,d.jsx)("div",{className:["rounded-2xl border bg-background p-4 space-y-3",l?"border-primary/50 ring-1 ring-primary/30":"border-border"].join(" "),children:(0,d.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,d.jsxs)("div",{className:"min-w-0",children:[(0,d.jsx)("div",{className:"text-sm font-semibold text-foreground truncate",children:c}),(0,d.jsx)("div",{className:"text-xs text-muted-foreground truncate",children:o})]}),(0,d.jsxs)("div",{className:"flex items-center gap-2 shrink-0",children:[(0,d.jsx)(r.$n,{variant:"outline",shape:"lg",onClick:t,children:i("loops.open","Open")}),(0,d.jsx)(r.$n,{variant:"default",shape:"lg",shadow:"sm",onClick:s,disabled:n,children:i("loops.add","Add")})]})]})})}function F(e,o){const l=Object.keys(m.BV);for(const a of l)if(e[a]!==o[a])return!1;return!0}function K(e){return"string"==typeof e&&e.trim().length>0}function z(e,o){const l=e[o];return"string"==typeof l?l:""}function D(e,o){const l=e[o],a="number"==typeof l?l:Number(l);return Number.isFinite(a)?a:0}function U({loop:e,userId:o,page:l,onPageChange:t}){const{t:s}=(0,a.Bd)(),[i,c]=(0,p.mk)(),[u,b]=(0,n.useState)(!1),[j,w]=(0,n.useState)(!1),[N,M]=(0,n.useState)(!1),[k,L]=(0,n.useState)(void 0),C={id:e.id,titles:e.titles,location:e.location??null,radiusKm:e.radiusKm??null,platforms:e.platforms,remoteMode:e.remoteMode,filters:e.filters},{draftFilters:S,setDraftFilters:A,applyDraftFilters:V,resetFilters:R,appliedFilters:q,activeLink:T,setActive:$,links:U}=function(e){const o=(0,n.useMemo)(()=>function(e){const o=(()=>{if(!h(e))return{};const o=e.filters;return h(o)?o:e})();return{role:f(o.role,m.BV.role),location:f(o.location,m.BV.location),radiusKm:x(g(o.radiusKm,m.BV.radiusKm),[5,10,20,30,50,100],m.BV.radiusKm),workMode:x(o.workMode,["any","onsite","hybrid","remote","remote_only"],m.BV.workMode),seniority:x(o.seniority,["intern","junior","mid","senior","lead"],m.BV.seniority),employmentType:x(o.employmentType,["full_time","part_time","contract","internship","ausbildung"],m.BV.employmentType),postedWithin:x(g(o.postedWithin,m.BV.postedWithin),[1,3,7,14,30],m.BV.postedWithin),includeKeywords:f(o.includeKeywords,m.BV.includeKeywords),excludeKeywords:f(o.excludeKeywords,m.BV.excludeKeywords),excludeAgencies:(l=o.excludeAgencies,a=m.BV.excludeAgencies,"boolean"==typeof l?l:a),language:x(o.language,["any","de","en"],m.BV.language)};var l,a}(e),[e]),[l,a]=(0,n.useState)(()=>o),[t,s]=(0,n.useState)(()=>o),[r,d]=(0,n.useState)(null),[i,c]=(0,n.useState)(!1);(0,n.useEffect)(()=>{a(o),s(o),d(null),c(!1)},[e.id]),(0,n.useEffect)(()=>{i||(a(e=>F(e,o)?e:o),s(e=>F(e,o)?e:o),d(null))},[o,i]);const u=(0,n.useCallback)(e=>{a(e),c(!F(e,o))},[o]),p=(0,n.useMemo)(()=>{return function(e,o){return e.map(e=>({platform:e,url:(0,m.ad)(e,o)}))}(e.platforms,{role:[[(o=t).role,o.includeKeywords].filter(Boolean).join(" ").trim(),(o.excludeKeywords||"").split(/\s+/g).filter(Boolean).map(e=>e.startsWith("-")?e:`-${e}`).join(" ")].filter(Boolean).join(" ").trim(),location:o.location,radiusKm:Number(o.radiusKm),workMode:"remote_only"===o.workMode?"remote_only":"any"});var o},[e.platforms,t]),b=(0,n.useCallback)(()=>{a(o),s(o),d(null),c(!1)},[o]),v=(0,n.useCallback)(()=>{s(l),d(null),c(!1)},[l]),y=(0,n.useCallback)((e,o)=>{d({platform:e,url:o})},[]);return{draftFilters:l,setDraftFilters:u,appliedFilters:t,applyDraftFilters:v,resetFilters:b,activeLink:r,setActiveLink:d,setActive:y,links:p}}(C),E=c.isLoading,_=Boolean(o)&&!E,W=12,G=Math.max(1,Math.ceil(U.length/W)),Y=Math.max(1,Math.min(G,(0,v.hD)(l))),J=(Y-1)*W,H=(0,n.useMemo)(()=>0===U.length?{from:0,to:0}:{from:J+1,to:Math.min(U.length,J+W)},[U.length,J,W]),Z=(0,n.useMemo)(()=>U.slice(J,J+W),[U,J,W]),Q=(0,n.useMemo)(()=>{const e=[],o=z(q,"role").trim(),l=z(q,"location").trim(),a=D(q,"radiusKm"),t=function(e){const o=e.workMode;return"string"==typeof o?o:"any"}(q),r=D(q,"postedWithin");return K(o)&&e.push(s("loops.badgeRole","Role: {{value}}",{value:o})),K(l)&&e.push(s("loops.badgeLoc","Loc: {{value}}",{value:l})),e.push(s("loops.badgeRadius","Radius: {{value}}km",{value:a})),"any"!==t&&e.push(s("loops.badgeMode","Mode: {{value}}",{value:t})),e.push(s("loops.badgePosted","Posted: {{value}}d",{value:r})),e},[q,s]),X=e=>{L(e),M(!0)};return(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsx)(P,{open:j,onOpenChange:w,value:S,onChange:A,disabled:E,onApply:async()=>{var l;if(V(),t(1),o)try{await i({loopId:e.id,name:e.name,titles:(0,m.CP)(S.role),location:S.location,radiusKm:S.radiusKm,remoteMode:(l=S.workMode,"remote_only"===l?"remote_only":"any"),filters:S}).unwrap(),w(!1)}catch(e){console.error("Failed to save filters:",(0,y.u)(e))}},onReset:()=>{R(),t(1)}}),(0,d.jsxs)("div",{className:"rounded-2xl border border-border bg-card p-4 sm:p-6 space-y-4",children:[(0,d.jsxs)("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-start sm:justify-between",children:[(0,d.jsxs)("div",{className:"flex min-w-0 flex-col gap-1",children:[(0,d.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,d.jsx)("h3",{className:"text-base font-semibold text-foreground",children:s("loops.searchLinksTitle","Search links")}),(0,d.jsx)("span",{className:"inline-flex items-center rounded-full border border-border bg-muted/40 px-2.5 py-0.5 text-xs font-medium text-muted-foreground",children:s("loops.showing","Showing {{from}}–{{to}} of {{total}}",{from:H.from,to:H.to,total:U.length})})]}),(0,d.jsx)("p",{className:"text-sm text-muted-foreground",children:s("loops.searchLinksSubtitle","Apply filters → open platform → pick a job → paste URL → save match.")}),(0,d.jsxs)("div",{className:"mt-2",children:[(0,d.jsxs)("details",{className:"sm:hidden",children:[(0,d.jsxs)("summary",{className:"cursor-pointer select-none text-sm text-muted-foreground",children:[s("loops.filters","Filters")," (",Q.length,")"]}),Q.length?(0,d.jsx)("div",{className:"mt-2 flex flex-wrap gap-2",children:Q.map(e=>(0,d.jsx)("span",{className:"rounded-full border border-border bg-background px-3 py-1 text-xs text-muted-foreground",children:e},e))}):(0,d.jsx)("div",{className:"mt-2 text-xs text-muted-foreground",children:s("loops.noFilters","No filters applied")})]}),Q.length?(0,d.jsx)("div",{className:"hidden sm:flex flex-wrap gap-2",children:Q.map(e=>(0,d.jsx)("span",{className:"rounded-full border border-border bg-background px-3 py-1 text-xs text-muted-foreground",children:e},e))}):null]})]}),(0,d.jsxs)("div",{className:"flex w-full flex-col gap-2 sm:w-auto sm:flex-row sm:items-center",children:[(0,d.jsx)(r.$n,{variant:"outline",shape:"lg",onClick:()=>w(!0),disabled:E,className:"w-full sm:w-auto",children:s("loops.myLoopSettings","My Loop settings")}),(0,d.jsx)(r.$n,{variant:"outline",shape:"lg",onClick:()=>b(!0),disabled:!_,className:"w-full sm:w-auto",children:s("loops.editSources","Edit sources")}),(0,d.jsx)(r.$n,{variant:"default",shape:"lg",shadow:"sm",onClick:()=>X(void 0),disabled:!o,className:"w-full sm:w-auto",children:s("loops.addMatch","Add match")})]}),(0,d.jsx)(I,{open:u,onOpenChange:b,value:e.platforms,disabled:!_,onSave:async l=>{if(o)try{await i({loopId:e.id,platforms:l}).unwrap()}catch(e){console.error("Failed to update sources:",(0,y.u)(e))}}})]}),(0,d.jsx)("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:Z.map(e=>{const l=T?.platform===e.platform&&T?.url===e.url;return(0,d.jsx)(O,{platform:e.platform,url:e.url,isActive:l,onOpen:()=>{return o=e.platform,l=e.url,$(o,l),void function(e){window.open(e,"_blank","noopener,noreferrer")}(l);var o,l},onAdd:()=>X(e.platform),addDisabled:!o},`${e.platform}:${e.url}`)})}),(0,d.jsx)("div",{className:"flex items-center justify-center",children:(0,d.jsx)(r.dK,{page:Y,totalPages:G,onPageChange:t,disabled:E})}),(0,d.jsx)(B,{open:N,onOpenChange:M,loopId:e.id,defaultPlatform:k})]})]})}var E=l(40457),_=l(338);function W({userId:e,loopId:o,onBack:l}){const{t:s}=(0,a.Bd)(),m=(0,t.Zp)(),h=(0,t.zy)(),f=(0,u.j)(),g=(0,u.G)(e=>e.loopsUi.detailsPageByLoopId[o]),x=(e=>{try{const o=new URLSearchParams(e).get("page"),l=o?Number(o):NaN,a=Number.isFinite(l)?Math.trunc(l):NaN;return a>0?a:null}catch{return null}})(h.search),y=x??g??1;(0,n.useEffect)(()=>{null===x&&(0,_.N)(m,h,{page:String(y)},{replace:!0})},[x,y,m,h]),(0,n.useEffect)(()=>{f((0,E.cc)({loopId:o,page:y})),f((0,E.XU)(`${h.pathname}${h.search}`))},[f,o,y,h.pathname,h.search]);const j=(0,p.uB)({loopId:o}),w=j.data??null,N=(0,n.useMemo)(()=>w?.name??s("loops.detailsTitle","Loop"),[w?.name,s]),M=(0,n.useMemo)(()=>{if(!w)return s("loops.detailsHint","Change filters → Apply → links update and filters persist.");const e=b(w.titles)||s("loops.dash","—"),o="remote_only"===w.remoteMode?s("loops.remoteOnly","Remote"):s("loops.any","Any");return`${e} · ${w.location} · ${o}`},[w,s]),k=(0,n.useMemo)(()=>j.isLoading?(0,d.jsx)(c,{children:s("loops.loadingLoop","Loading loop…")}):j.isError?(0,d.jsx)(c,{children:(0,v.u1)(j.error)}):w?(0,d.jsx)(U,{userId:e,page:y,onPageChange:e=>{f((0,E.cc)({loopId:o,page:e})),(0,_.N)(m,h,{page:String(e)},{replace:!0})},loop:{id:w.id,name:w.name,titles:w.titles,location:w.location,radiusKm:w.radiusKm,platforms:w.platforms,remoteMode:w.remoteMode,filters:w.filters}}):(0,d.jsx)(c,{children:s("loops.notFound","Loop not found.")}),[j.isLoading,j.isError,j.error,w,s,e,y,f,o,m,h]);return(0,d.jsxs)("div",{className:"space-y-6",children:[(0,d.jsx)(i,{title:N,subtitle:M,right:(0,d.jsx)(r.$n,{variant:"outline",shape:"lg",onClick:l,children:s("loops.back","Back")})}),k]})}var G=l(29189),Y=l(73431);function J(e,o){const l=new URLSearchParams(e);l.set("page",String((0,v.hD)(o)));const a=l.toString();return a?`?${a}`:""}function H({userId:e,onOpenLoop:o}){const{t:l}=(0,a.Bd)(),s=(0,t.Zp)(),i=(0,t.zy)(),c=(0,u.j)(),m=(0,u.G)(e=>e.loopsUi.listPage),[h,f]=(0,n.useState)(!1),g=(0,n.useMemo)(()=>function(e){const o=new URLSearchParams(e).get("page");if(!o)return null;const l=Number(o);return(0,v.hD)(l)}(i.search)??(0,v.hD)(m),[i.search,m]),x=(0,n.useRef)({1:null}),[y,j]=(0,n.useState)(null),[w]=(0,p.s8)(),N=(0,n.useCallback)(async o=>{if(!e)return void j(null);if(o<=1)return x.current[1]=null,void j(null);const l=x.current;if(void 0===l[o]){void 0===l[1]&&(l[1]=null);for(let e=1;e<o&&void 0!==l[e];e+=1){const o=l[e]??null,a=await w({pageSize:7,cursorId:o}).unwrap();if(l[e+1]=a.nextCursor??null,!a.nextCursor)break}j(l[o]??null)}else j(l[o]??null)},[w,e]);(0,n.useEffect)(()=>{let e=!1;return(async()=>{try{await N(g)}catch{}})().catch(()=>{}),()=>{e=!0}},[g,N]);const M=(0,p.wB)(e?{pageSize:7,cursorId:y}:G.hT),k=M.data,L=(0,n.useMemo)(()=>k?.items??[],[k]),C=k?.total??0,S=M.data?.nextCursor??null,B=(0,n.useMemo)(()=>{const e=Math.ceil(C/7);return e<=0?1:e},[C]);(0,n.useEffect)(()=>{if(!M.data)return;const e=g+1,o=x.current;void 0===o[e]&&(o[e]=S)},[M.data,g,S]),(0,n.useEffect)(()=>{if(!M.data)return;const e=Math.max(1,Math.min(B,g));if(e!==g){const o=J(i.search,e);s({pathname:i.pathname,search:o},{replace:!0})}},[M.data,g,B,s,i.pathname,i.search]),(0,n.useEffect)(()=>{c((0,E.t0)(g)),c((0,E.XU)(`${i.pathname}${i.search}`))},[c,g,i.pathname,i.search]);const A=(0,n.useCallback)(async e=>{const o=(0,v.hD)(e);await N(o);const l=J(i.search,o);s({pathname:i.pathname,search:l},{replace:!1})},[s,i.pathname,i.search,N]),I=(0,n.useMemo)(()=>0===C?0:7*(g-1)+1,[g,C]),V=(0,n.useMemo)(()=>0===C?0:7*(g-1)+L.length,[g,C,L.length]),R=(0,n.useMemo)(()=>M.isLoading?(0,d.jsx)("div",{className:"text-sm text-muted-foreground",children:l("loops.loading","Loading…")}):M.isError?(0,d.jsx)("div",{className:"text-sm text-muted-foreground",children:(0,v.u1)(M.error)}):0===C?(0,d.jsx)("div",{className:"text-sm text-muted-foreground",children:l("loops.empty","No loops yet. Create your first loop.")}):(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsx)("div",{className:"space-y-3",children:L.map(e=>{const a=b(e.titles)||l("loops.dash","—"),t="remote_only"===e.remoteMode?l("loops.remoteOnly","Remote"):l("loops.any","Any");return(0,d.jsxs)("div",{tabIndex:0,onClick:()=>o(e.id),onKeyDown:l=>{"Enter"!==l.key&&" "!==l.key||(l.preventDefault(),o(e.id))},className:["w-full","rounded-xl border border-border bg-background","px-4 py-4","hover:bg-muted transition-colors","focus:outline-none focus:ring-2 focus:ring-border","cursor-pointer","select-none"].join(" "),children:[(0,d.jsx)("div",{className:"text-sm font-semibold text-foreground",children:e.name}),(0,d.jsxs)("div",{className:"mt-1 text-xs text-muted-foreground",children:[e.location," · ",a," · ",t]})]},e.id)})}),(0,d.jsxs)("div",{className:"grid grid-cols-3 items-center",children:[(0,d.jsx)("div",{className:"text-xs text-muted-foreground",children:l("loops.showing","Showing {{from}}–{{to}} of {{total}}",{from:I,to:V,total:C})}),(0,d.jsx)(r.dK,{page:g,totalPages:B,onPageChange:A,disabled:M.isFetching,siblingCount:1})]})]}),[M.isLoading,M.isError,M.error,M.isFetching,L,o,g,I,V,l,C,B,A]);return(0,d.jsxs)("div",{className:"space-y-6",children:[(0,d.jsx)(r.zY,{title:l("loops.listTitle","My Loops"),subtitle:l("loops.listSubtitle","Create a loop and track matches."),right:(0,d.jsx)(r.$n,{variant:"default",shadow:"sm",shape:"lg",onClick:()=>f(!0),children:l("loops.newLoop","New loop")})}),(0,d.jsx)("div",{className:"rounded-2xl border border-border bg-card p-6",children:R}),(0,d.jsx)(Y.Wk,{open:h,onOpenChange:f,onCreated:e=>{x.current={1:null},j(null);const l=J(i.search,1);s({pathname:i.pathname,search:l},{replace:!0}),o(e)}})]})}function Z(){const{t:e}=(0,a.Bd)(),{userId:o}=(0,s.gv)(),l=(0,t.Zp)(),n=(0,t.zy)(),{loopId:u}=(0,t.g)(),p=Boolean(u),m=()=>l(`/dashboard/loops${n.search}`);return o?p?(0,d.jsx)(W,{userId:o,loopId:u,onBack:m}):(0,d.jsx)(H,{userId:o,onOpenLoop:e=>l(`/dashboard/loops/${e}${n.search}`)}):(0,d.jsxs)("div",{className:"space-y-6",children:[(0,d.jsx)(i,{title:p?e("loops.detailsTitle","Loop"):e("loops.listTitle","My Loops"),subtitle:e("loops.signInSubtitle","Sign in to continue."),right:p?(0,d.jsx)(r.$n,{variant:"outline",shape:"lg",onClick:m,children:e("loops.back","Back")}):null}),(0,d.jsx)(c,{children:e("loops.signInBody","Please sign in to view your loops.")})]})}},65546(e,o,l){l(24589),l(80784)}}]);
//# sourceMappingURL=4012.ea4fd788.chunk.js.map