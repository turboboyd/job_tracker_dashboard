{"version":3,"file":"assets/js/4665.564691bb.chunk.js","mappings":"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","sources":["webpack://job-tracker-dashboard/./src/pages/BoardPage/model/order.ts","webpack://job-tracker-dashboard/./src/pages/BoardPage/model/useBoardController.ts","webpack://job-tracker-dashboard/./src/pages/BoardPage/model/useBoardQueries.ts","webpack://job-tracker-dashboard/./src/pages/BoardPage/model/useBoardOrderState.ts","webpack://job-tracker-dashboard/./src/pages/BoardPage/model/useBoardMutations.ts","webpack://job-tracker-dashboard/./src/pages/BoardPage/model/grouping.ts","webpack://job-tracker-dashboard/./src/pages/BoardPage/ui/BoardLane.tsx","webpack://job-tracker-dashboard/./src/pages/BoardPage/ui/BoardMatchCardView.tsx","webpack://job-tracker-dashboard/./src/pages/BoardPage/ui/BoardMatchCard.tsx","webpack://job-tracker-dashboard/./src/pages/BoardPage/ui/BoardColumn.tsx","webpack://job-tracker-dashboard/./src/pages/BoardPage/ui/boardColumns/columnsState.ts","webpack://job-tracker-dashboard/./src/pages/BoardPage/ui/BoardColumns.tsx","webpack://job-tracker-dashboard/./src/pages/BoardPage/ui/boardColumns/useBoardColumnsDnd.ts","webpack://job-tracker-dashboard/./src/pages/BoardPage/ui/BoardState.tsx","webpack://job-tracker-dashboard/./src/pages/BoardPage/BoardPage.tsx"],"sourcesContent":["import { LOOP_MATCH_STATUSES } from \"src/entities/loop\";\nimport type { LoopMatch, LoopMatchStatus } from \"src/entities/loopMatch\";\n\nimport type { BoardOrderByStatus } from \"./types\";\n\nfunction storageKey(userId: string) {\n  return `board_order_v1:${userId}`;\n}\n\nfunction statusValuesSet(): Set<string> {\n  return new Set(LOOP_MATCH_STATUSES.map((s) => String(s.value)));\n}\n\nfunction isValidStatus(value: unknown): value is LoopMatchStatus {\n  if (typeof value !== \"string\") return false;\n  return statusValuesSet().has(value);\n}\n\nexport function createEmptyOrder(): BoardOrderByStatus {\n  const obj = {} as BoardOrderByStatus;\n  for (const s of LOOP_MATCH_STATUSES) obj[s.value] = [];\n  return obj;\n}\n\nexport function loadOrder(userId: string): BoardOrderByStatus {\n  try {\n    const raw = localStorage.getItem(storageKey(userId));\n    if (!raw) return createEmptyOrder();\n\n    const parsed = JSON.parse(raw) as Partial<Record<LoopMatchStatus, unknown>>;\n\n    const base = createEmptyOrder();\n    for (const s of LOOP_MATCH_STATUSES) {\n      const key = s.value;\n      const arr = Array.isArray(parsed?.[key]) ? (parsed?.[key] as unknown[]) : [];\n      base[key] = arr.filter((x): x is string => typeof x === \"string\");\n    }\n    return base;\n  } catch {\n    return createEmptyOrder();\n  }\n}\n\nexport function saveOrder(userId: string, order: BoardOrderByStatus): void {\n  try {\n    localStorage.setItem(storageKey(userId), JSON.stringify(order));\n  } catch {\n    // ignore\n  }\n}\n\n/**\n * Делает order \"железобетонным\":\n * 1) гарантирует массивы для всех статусов\n * 2) удаляет id, которых нет в matches\n * 3) добавляет отсутствующие id в правильный статус (невалидный статус -> \"new\")\n */\nexport function ensureIdsExist(order: BoardOrderByStatus, matches: readonly LoopMatch[]): void {\n  // 1) Ensure all statuses exist\n  for (const s of LOOP_MATCH_STATUSES) {\n    const key = s.value;\n    if (!Array.isArray(order[key])) order[key] = [];\n  }\n\n  const existingIds = new Set(matches.map((m) => m.id));\n\n  // 2) Remove ids that no longer exist\n  for (const s of LOOP_MATCH_STATUSES) {\n    const key = s.value;\n    order[key] = (order[key] ?? []).filter((id) => existingIds.has(id));\n  }\n\n  // 3) Add missing ids into the correct bucket\n  for (const m of matches) {\n    const status: LoopMatchStatus = isValidStatus(m.status) ? m.status : \"new\";\n    const arr = order[status] ?? (order[status] = []);\n    if (!arr.includes(m.id)) arr.push(m.id);\n  }\n}\n\nexport function moveInArray<T>(arr: readonly T[], from: number, to: number): T[] {\n  const copy = [...arr];\n  const [item] = copy.splice(from, 1);\n  copy.splice(to, 0, item);\n  return copy;\n}\n\n\nexport function sortByOrder(\n  matches: readonly LoopMatch[],\n  orderIds: readonly string[],\n): LoopMatch[] {\n  const idx = new Map<string, number>();\n  for (let i = 0; i < orderIds.length; i++) idx.set(orderIds[i], i);\n\n  const decorated = matches.map((m, i) => ({\n    m,\n    rank: idx.has(m.id) ? (idx.get(m.id) as number) : Number.MAX_SAFE_INTEGER,\n    stable: i,\n  }));\n\n  decorated.sort((a, b) => {\n    if (a.rank !== b.rank) return a.rank - b.rank;\n    return a.stable - b.stable;\n  });\n\n  return decorated.map((x) => x.m);\n}\n","import React from \"react\";\n\nimport { useAuthSelectors } from \"src/entities/auth\";\nimport { LOOP_MATCH_STATUSES } from \"src/entities/loop\";\nimport type { LoopMatch, LoopMatchStatus } from \"src/entities/loopMatch\";\n\nimport { groupMatchesByStatus } from \"./grouping\";\nimport { sortByOrder } from \"./order\";\nimport type { BoardDragPayload, BoardVM } from \"./types\";\nimport { useBoardMutations, fireAndForgetMutation } from \"./useBoardMutations\";\nimport { useBoardOrderState } from \"./useBoardOrderState\";\nimport { useBoardQueries } from \"./useBoardQueries\";\n\nfunction buildLoopIdToName(loops: ReadonlyArray<{ id: string; name: string }>): ReadonlyMap<string, string> {\n  const map = new Map<string, string>();\n  for (const l of loops) map.set(l.id, l.name);\n  return map;\n}\n\nfunction findMatchById(matches: readonly LoopMatch[], matchId: string): LoopMatch | undefined {\n  return matches.find((m) => m.id === matchId);\n}\n\nfunction buildBoardColumns(\n  matches: readonly LoopMatch[],\n  orderByStatus: Record<LoopMatchStatus, string[]>,\n): ReadonlyMap<LoopMatchStatus, readonly LoopMatch[]> {\n  const grouped = groupMatchesByStatus(matches);\n\n\n  for (const s of LOOP_MATCH_STATUSES) {\n    const status = s.value;\n    const list = grouped.get(status) ?? [];\n    const ordered = sortByOrder(list, orderByStatus[status] ?? []);\n    grouped.set(status, ordered);\n  }\n\n  return grouped as ReadonlyMap<LoopMatchStatus, readonly LoopMatch[]>;\n}\n\nexport function useBoardController(): BoardVM {\n  const { userId } = useAuthSelectors();\n\n\n  const { loops, matches, matchesQ } = useBoardQueries();\n  const loopIdToName = React.useMemo(() => buildLoopIdToName(loops), [loops]);\n\n\n  const { orderByStatus, applyDrop } = useBoardOrderState({ userId, matches });\n\n\n  const { busy, onDeleteById, updateStatus } = useBoardMutations();\n\n\n  const byStatus = React.useMemo(\n    () => buildBoardColumns(matches, orderByStatus),\n    [matches, orderByStatus],\n  );\n\n\n  const onDelete = React.useCallback(\n    (matchId: string) => {\n      fireAndForgetMutation(onDeleteById(matches, matchId));\n    },\n    [matches, onDeleteById],\n  );\n\n  const onDropToStatus = React.useCallback(\n    async (payload: BoardDragPayload, toStatus: LoopMatchStatus, toIndex: number) => {\n      if (!userId) return;\n      if (busy) return;\n\n\n      applyDrop(payload, toStatus, toIndex);\n\n\n      if (payload.fromStatus === toStatus) return;\n\n      const match = findMatchById(matches, payload.matchId);\n      if (!match) return;\n\n      await updateStatus({ matchId: match.id, loopId: match.loopId, status: toStatus });\n    },\n    [applyDrop, busy, matches, updateStatus, userId],\n  );\n\n  return {\n    busy,\n    queries: { matchesQ },\n    data: { matches, byStatus, loopIdToName },\n    actions: { onDelete, onDropToStatus },\n  };\n}\n","import React from \"react\";\n\nimport { useGetLoopsQuery, type Loop } from \"src/entities/loop\";\nimport { useGetAllMatchesQuery, type LoopMatch } from \"src/entities/loopMatch\";\n\nimport type { BoardMatchesQueryState } from \"./types\";\n\nexport type BoardQueries = Readonly<{\n  loops: readonly Loop[];\n  matches: readonly LoopMatch[];\n  matchesQ: BoardMatchesQueryState;\n}>;\n\n\nexport function useBoardQueries(): BoardQueries {\n  const loopsQ = useGetLoopsQuery();\n  const matchesQ = useGetAllMatchesQuery();\n\n  const loops = React.useMemo(() => loopsQ.data ?? [], [loopsQ.data]);\n  const matches = React.useMemo(() => matchesQ.data ?? [], [matchesQ.data]);\n\n  const matchesQueryState: BoardMatchesQueryState = React.useMemo(\n    () => ({\n      isLoading: matchesQ.isLoading,\n      isError: matchesQ.isError,\n      error: matchesQ.error,\n    }),\n    [matchesQ.error, matchesQ.isError, matchesQ.isLoading],\n  );\n\n  return { loops, matches, matchesQ: matchesQueryState };\n}\n","import React from \"react\";\n\nimport type { LoopMatch, LoopMatchStatus } from \"src/entities/loopMatch\";\n\nimport { createEmptyOrder, ensureIdsExist, loadOrder, saveOrder } from \"./order\";\nimport type { BoardDragPayload, BoardOrderByStatus } from \"./types\";\n\n\nexport type BoardOrderController = Readonly<{\n  orderByStatus: BoardOrderByStatus;\n  applyDrop: (payload: BoardDragPayload, toStatus: LoopMatchStatus, toIndex: number) => void;\n}>;\n\nexport function useBoardOrderState(params: Readonly<{\n  userId: string | null | undefined;\n  matches: readonly LoopMatch[];\n}>): BoardOrderController {\n  const { userId, matches } = params;\n\n\n  const [orderByStatus, setOrderByStatus] = React.useState<BoardOrderByStatus>(() => {\n    if (!userId) return createEmptyOrder();\n    return loadOrder(userId);\n  });\n\n  React.useEffect(() => {\n    if (!userId) {\n      setOrderByStatus(createEmptyOrder());\n      return;\n    }\n    setOrderByStatus(loadOrder(userId));\n  }, [userId]);\n\n\n  React.useEffect(() => {\n    if (!userId) return;\n\n    setOrderByStatus((prev) => {\n      const next: BoardOrderByStatus = { ...prev };\n      ensureIdsExist(next, matches);\n      saveOrder(userId, next);\n      return next;\n    });\n  }, [matches, userId]);\n\n  const applyDrop = React.useCallback(\n    (payload: BoardDragPayload, toStatus: LoopMatchStatus, toIndex: number) => {\n      if (!userId) return;\n\n      setOrderByStatus((prev) => {\n        const next: BoardOrderByStatus = { ...prev };\n\n        const fromArr = [...(next[payload.fromStatus] ?? [])];\n        const toArr = payload.fromStatus === toStatus ? fromArr : [...(next[toStatus] ?? [])];\n\n        const currentFromIndex = fromArr.indexOf(payload.matchId);\n        if (currentFromIndex !== -1) fromArr.splice(currentFromIndex, 1);\n\n        const safeIndex = Math.max(0, Math.min(toIndex, toArr.length));\n        toArr.splice(safeIndex, 0, payload.matchId);\n\n        next[payload.fromStatus] = payload.fromStatus === toStatus ? toArr : fromArr;\n        next[toStatus] = toArr;\n\n        saveOrder(userId, next);\n        return next;\n      });\n    },\n    [userId],\n  );\n\n  return { orderByStatus, applyDrop };\n}\n","import React from \"react\";\n\nimport {\n  useDeleteMatchMutation,\n  useUpdateMatchStatusMutation,\n  type LoopMatch,\n  type LoopMatchStatus,\n} from \"src/entities/loopMatch\";\n\nexport type BoardMutations = Readonly<{\n  busy: boolean;\n  deleteMatch: (args: Readonly<{ matchId: string; loopId: string }>) => Promise<unknown>;\n  updateStatus: (args: Readonly<{ matchId: string; loopId: string; status: LoopMatchStatus }>) => Promise<unknown>;\n  onDeleteById: (matches: readonly LoopMatch[], matchId: LoopMatch[\"id\"]) => Promise<void>;\n}>;\n\nfunction fireAndForget(p: Promise<unknown>): void {\n  p.catch(() => {\n    // Errors are handled by RTK Query state in UI.\n  });\n}\n\n\nexport function useBoardMutations(): BoardMutations {\n  const [deleteMatchTrigger, deleteState] = useDeleteMatchMutation();\n  const [updateStatusTrigger, updateState] = useUpdateMatchStatusMutation();\n\n  const busy = Boolean(deleteState.isLoading || updateState.isLoading);\n\n  const deleteMatch = React.useCallback(\n    async (args: Readonly<{ matchId: string; loopId: string }>) => {\n      return deleteMatchTrigger(args);\n    },\n    [deleteMatchTrigger],\n  );\n\n  const updateStatus = React.useCallback(\n    async (args: Readonly<{ matchId: string; loopId: string; status: LoopMatchStatus }>) => {\n      return updateStatusTrigger(args);\n    },\n    [updateStatusTrigger],\n  );\n\n  const onDeleteById = React.useCallback(\n    async (matches: readonly LoopMatch[], matchId: LoopMatch[\"id\"]) => {\n      const match = matches.find((m) => m.id === matchId);\n      if (!match) return;\n      await deleteMatch({ matchId: match.id, loopId: match.loopId });\n    },\n    [deleteMatch],\n  );\n\n  return {\n    busy,\n    deleteMatch,\n    updateStatus,\n    onDeleteById,\n  };\n}\n\n\nexport function fireAndForgetMutation(p: Promise<unknown>): void {\n  fireAndForget(p);\n}\n","import { LOOP_MATCH_STATUSES } from \"src/entities/loop\";\nimport type { LoopMatch, LoopMatchStatus } from \"src/entities/loopMatch\";\n\n\nexport function groupMatchesByStatus(\n  matches: readonly LoopMatch[],\n): Map<LoopMatchStatus, LoopMatch[]> {\n  const map = new Map<LoopMatchStatus, LoopMatch[]>();\n\n  for (const s of LOOP_MATCH_STATUSES) {\n    map.set(s.value, []);\n  }\n\n  for (const match of matches) {\n    (map.get(match.status) ?? []).push(match);\n  }\n\n  return map;\n}\n","import { useDroppable } from \"@dnd-kit/core\";\nimport React from \"react\";\n\nimport type { LoopMatchStatus } from \"src/entities/loopMatch\";\nimport { classNames } from \"src/shared/lib\";\n\ntype Props = Readonly<{\n  status: LoopMatchStatus;\n  children: React.ReactNode;\n}>;\n\nexport function BoardLane({ status, children }: Props) {\n  const droppableId = `lane:${status}`;\n\n  const { setNodeRef, isOver } = useDroppable({\n    id: droppableId,\n  });\n\n  return (\n    <div\n      ref={setNodeRef}\n      className={classNames(\n        \"flex-1 min-h-0\",\n        \"rounded-xl border border-border bg-muted/40\",\n        \"p-sm md:p-md\",\n        \"overflow-y-auto overflow-x-hidden\",\n        isOver && \"bg-muted ring-2 ring-primary/40\",\n      )}\n    >\n      {children}\n    </div>\n  );\n}\n","import { Trash2 } from \"lucide-react\";\nimport React from \"react\";\nimport { useTranslation } from \"react-i18next\";\n\nimport {\n  MatchDetailsModal,\n  formatMatchedAt,\n  normalizePlatform,\n  type LoopMatch,\n} from \"src/entities/loopMatch\";\nimport { classNames } from \"src/shared/lib\";\nimport { Card } from \"src/shared/ui\";\n\nexport type BoardMatchCardViewProps = Readonly<{\n  match: LoopMatch;\n  loopName: string;\n  busy: boolean;\n  onDelete: (matchId: LoopMatch[\"id\"]) => void | Promise<void>;\n  overlay?: boolean;\n}>;\n\nexport function BoardMatchCardView({\n  match,\n  loopName,\n  busy,\n  onDelete,\n  overlay = false,\n}: BoardMatchCardViewProps) {\n  const { t } = useTranslation();\n  const [open, setOpen] = React.useState(false);\n\n  const onQuickDelete = React.useCallback(\n    (e: React.SyntheticEvent) => {\n      e.preventDefault();\n      e.stopPropagation();\n      if (busy || overlay) return;\n\n      const ok = window.confirm(\n        t(\"board.deleteConfirm\", \"Delete this job from the board?\"),\n      );\n      if (!ok) return;\n\n      Promise.resolve(onDelete(match.id)).catch(() => {});\n    },\n    [busy, overlay, onDelete, match.id, t],\n  );\n\n  const title = React.useMemo(\n    () => String(match.title ?? \"\").trim() || \"—\",\n    [match.title],\n  );\n  const company = React.useMemo(\n    () => String(match.company ?? \"\").trim() || \"—\",\n    [match.company],\n  );\n  const matchedAt = React.useMemo(\n    () => formatMatchedAt(match.matchedAt),\n    [match.matchedAt],\n  );\n\n  const platform = React.useMemo(() => {\n    const p = normalizePlatform(match.platform);\n    return p ? p.toUpperCase() : \"\";\n  }, [match.platform]);\n\n  const meta = React.useMemo(() => {\n    const parts = [match.location, platform, matchedAt, loopName]\n      .map((v) => String(v ?? \"\").trim())\n      .filter(Boolean);\n    return parts.join(\" • \");\n  }, [match.location, matchedAt, loopName, platform]);\n\n  const url = React.useMemo(() => String(match.url ?? \"\").trim(), [match.url]);\n  const hasUrl = Boolean(url);\n\n  const onOpen = React.useCallback(() => {\n    if (!busy && !overlay) setOpen(true);\n  }, [busy, overlay]);\n  let cursorClass: string;\n\n  if (overlay) {\n    cursorClass = \"cursor-grabbing\";\n  } else if (busy) {\n    cursorClass = \"opacity-60 cursor-not-allowed\";\n  } else {\n    cursorClass = \"cursor-pointer md:cursor-grab\";\n  }\n\n  return (\n    <>\n      <div\n        role=\"button\"\n        tabIndex={0}\n        onClick={onOpen}\n        onKeyDown={(e) => {\n          if (e.key === \"Enter\" || e.key === \" \") onOpen();\n        }}\n        className={classNames(\n          \"rounded-xl outline-none\",\n          cursorClass,\n          \"focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background\",\n        )}\n      >\n        <Card\n          variant=\"default\"\n          padding=\"md\"\n          shadow=\"sm\"\n          interactive={!overlay}\n          className={classNames(\n            \"relative flex flex-col gap-sm\",\n            \"transition-[box-shadow,transform] duration-fast ease-ease-out\",\n            !busy && !overlay && \"hover:shadow-md hover:-translate-y-[1px]\",\n            overlay && \"shadow-lg\",\n          )}\n        >\n          {!overlay ? (\n            <button\n              type=\"button\"\n              aria-label={t(\"board.delete\", \"Delete\")}\n              title={t(\"board.delete\", \"Delete\")}\n              disabled={busy}\n              className={classNames(\n                \"absolute right-2 top-2\",\n                \"inline-flex h-10 w-10 md:h-8 md:w-8 items-center justify-center rounded-full\",\n                \"border border-border bg-card text-muted-foreground\",\n                \"shadow-sm\",\n                \"hover:bg-muted hover:text-foreground\",\n                \"disabled:opacity-50 disabled:cursor-not-allowed\",\n                \"focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background\",\n              )}\n              onPointerDown={(e) => {\n                e.preventDefault();\n                e.stopPropagation();\n              }}\n              onClick={onQuickDelete}\n            >\n              <Trash2 className=\"h-5 w-5 md:h-4 md:w-4\" />\n            </button>\n          ) : null}\n\n          <div className=\"min-w-0\">\n            <div className=\"min-w-0 whitespace-nowrap overflow-hidden text-ellipsis text-sm\">\n              <span className=\"font-semibold text-foreground\">{title}</span>\n              <span className=\"ml-2 text-muted-foreground\">{company}</span>\n            </div>\n\n            {meta ? (\n              <div className=\"mt-1 text-xs text-muted-foreground whitespace-nowrap overflow-hidden text-ellipsis\">\n                {meta}\n              </div>\n            ) : null}\n          </div>\n\n          {hasUrl ? (\n            <div className=\"pt-2\">\n              <a\n                href={url}\n                target=\"_blank\"\n                rel=\"noopener noreferrer\"\n                className=\"text-xs text-primary underline hover:no-underline\"\n                onClick={(e) => e.stopPropagation()}\n              >\n                {t(\"board.openLink\", \"Open link\")}\n              </a>\n            </div>\n          ) : null}\n        </Card>\n      </div>\n\n      {!overlay ? (\n        <MatchDetailsModal\n          open={open}\n          onOpenChange={setOpen}\n          match={match}\n          loopName={loopName}\n          busy={busy}\n          onDelete={(id) => {\n            Promise.resolve(onDelete(id)).catch(() => {});\n          }}\n        />\n      ) : null}\n    </>\n  );\n}\n","import { useSortable } from \"@dnd-kit/sortable\";\nimport { CSS } from \"@dnd-kit/utilities\";\nimport React from \"react\";\n\nimport type { LoopMatch } from \"src/entities/loopMatch\";\nimport { classNames } from \"src/shared/lib\";\n\nimport { BoardMatchCardView } from \"./BoardMatchCardView\";\n\ntype Props = Readonly<{\n  match: LoopMatch;\n  loopName: string;\n  busy: boolean;\n  onDelete: (matchId: LoopMatch[\"id\"]) => void | Promise<void>;\n  index: number;\n  overlay?: boolean;\n}>;\n\nexport function BoardMatchCard({ match, loopName, busy, onDelete, index }: Props) {\n  const { setNodeRef, attributes, listeners, transform, transition, isDragging } =\n    useSortable({\n      id: match.id,\n      disabled: busy,\n      data: {\n        matchId: match.id,\n        status: match.status,\n        index,\n      },\n    });\n\n  const style: React.CSSProperties = {\n    transform: CSS.Transform.toString(transform),\n    transition,\n    opacity: isDragging ? 0.25 : 1,\n  };\n\n  return (\n    <div\n      ref={setNodeRef}\n      style={style}\n      // Mobile: keep vertical scroll usable while still allowing drag after long-press.\n      className={classNames(\n        \"select-none touch-pan-y touch-manipulation md:touch-none\",\n        isDragging && \"z-10\",\n      )}\n      {...attributes}\n      {...listeners}\n    >\n      <BoardMatchCardView\n        match={match}\n        loopName={loopName}\n        busy={busy}\n        onDelete={onDelete}\n        overlay={false}\n      />\n    </div>\n  );\n}\n\n\nexport function BoardMatchCardOverlay({\n  match,\n  loopName,\n  busy,\n  onDelete,\n}: Omit<Props, \"index\">) {\n  return (\n    <div className=\"rotate-[1deg]\">\n      <BoardMatchCardView\n        match={match}\n        loopName={loopName}\n        busy={busy}\n        onDelete={onDelete}\n        overlay\n      />\n    </div>\n  );\n}\n","import { SortableContext, verticalListSortingStrategy } from \"@dnd-kit/sortable\";\nimport React from \"react\";\nimport { useTranslation } from \"react-i18next\";\n\nimport type { LoopMatch, LoopMatchStatus } from \"src/entities/loopMatch\";\nimport { Card } from \"src/shared/ui\";\n\nimport { BoardLane } from \"./BoardLane\";\nimport { BoardMatchCard } from \"./BoardMatchCard\";\n\ntype Props = Readonly<{\n  status: LoopMatchStatus;\n  title: string;\n  matches: readonly LoopMatch[];\n  loopIdToName: ReadonlyMap<string, string>;\n  busy: boolean;\n  onDelete: (matchId: string) => void | Promise<void>;\n}>;\n\nexport function BoardColumn({\n  status,\n  title,\n  matches,\n  loopIdToName,\n  busy,\n  onDelete,\n}: Props) {\n  const { t } = useTranslation();\n\n  const itemIds = React.useMemo(() => matches.map((m) => m.id), [matches]);\n\n  return (\n    <div className=\"w-[calc(100vw-2rem)] md:w-[320px] shrink-0 h-full min-h-0 flex flex-col\">\n      <Card\n        variant=\"subtle\"\n        padding=\"md\"\n        shadow=\"none\"\n        className=\"shrink-0 mb-sm md:mb-md\"\n      >\n        <div className=\"flex items-center justify-between\">\n          <div className=\"text-sm font-semibold text-foreground\">{title}</div>\n          <div className=\"text-xs text-muted-foreground\">{matches.length}</div>\n        </div>\n      </Card>\n\n      <BoardLane status={status}>\n        <SortableContext\n          id={status}                 \n          items={itemIds}\n          strategy={verticalListSortingStrategy}\n        >\n          <div className=\"flex flex-col gap-sm md:gap-md\">\n            {matches.map((m, i) => (\n              <BoardMatchCard\n                key={m.id}\n                match={m}\n                loopName={loopIdToName.get(m.loopId) ?? \"\"}\n                busy={busy}\n                onDelete={onDelete}\n                index={i}\n              />\n            ))}\n          </div>\n        </SortableContext>\n\n        {matches.length === 0 ? (\n          <div className=\"pt-md text-xs text-muted-foreground\">\n            {t(\"board.dropHere\", \"Drop matches here.\")}\n          </div>\n        ) : null}\n      </BoardLane>\n    </div>\n  );\n}\n","import { LOOP_MATCH_STATUSES } from \"src/entities/loop\";\nimport type { LoopMatch, LoopMatchStatus } from \"src/entities/loopMatch\";\n\nimport type { BoardVM } from \"../../model/types\";\n\nexport type ColumnsState = Map<LoopMatchStatus, LoopMatch[]>;\n\nexport function cloneColumns(src: ColumnsState): ColumnsState {\n  const m = new Map<LoopMatchStatus, LoopMatch[]>();\n  for (const [k, v] of src.entries()) m.set(k, [...v]);\n  return m;\n}\n\nexport function buildColumnsFromVm(vm: BoardVM): ColumnsState {\n  const m = new Map<LoopMatchStatus, LoopMatch[]>();\n  for (const s of LOOP_MATCH_STATUSES) {\n    m.set(s.value, [...(vm.data.byStatus.get(s.value) ?? [])]);\n  }\n  return m;\n}\n\nexport function findContainerOfId(\n  state: ColumnsState,\n  matchId: string,\n): LoopMatchStatus | null {\n  for (const [status, list] of state.entries()) {\n    if (list.some((x) => x.id === matchId)) return status;\n  }\n  return null;\n}\n\nexport function removeFromList(\n  list: LoopMatch[],\n  id: string,\n): { next: LoopMatch[]; item: LoopMatch | null } {\n  const idx = list.findIndex((x) => x.id === id);\n  if (idx === -1) return { next: list, item: null };\n  const item = list[idx];\n  const next = [...list.slice(0, idx), ...list.slice(idx + 1)];\n  return { next, item };\n}\n\nexport function insertIntoList(\n  list: LoopMatch[],\n  item: LoopMatch,\n  index: number,\n): LoopMatch[] {\n  const i = Math.max(0, Math.min(index, list.length));\n  return [...list.slice(0, i), item, ...list.slice(i)];\n}\n\nexport function getLaneStatusFromOverId(\n  overId: string,\n): LoopMatchStatus | null {\n\n  if (overId.startsWith(\"lane:\")) return overId.slice(5) as LoopMatchStatus;\n  if (overId.startsWith(\"lane-tab:\")) return overId.slice(9) as LoopMatchStatus;\n  return null;\n}\n","import { DndContext, DragOverlay, closestCorners, useDroppable } from \"@dnd-kit/core\";\nimport React from \"react\";\nimport { useTranslation } from \"react-i18next\";\n\nimport { LOOP_MATCH_STATUSES } from \"src/entities/loop\";\nimport type { LoopMatchStatus } from \"src/entities/loopMatch\";\n\nimport type { BoardVM } from \"../model/types\";\n\nimport { BoardColumn } from \"./BoardColumn\";\nimport { useBoardColumnsDnd } from \"./boardColumns/useBoardColumnsDnd\";\nimport { BoardMatchCardOverlay } from \"./BoardMatchCard\";\n\nfunction StatusTabTarget({\n  status,\n  label,\n  isActive,\n  onClick,\n}: {\n  status: LoopMatchStatus;\n  label: string;\n  isActive: boolean;\n  onClick: () => void;\n}) {\n  const droppableId = `lane-tab:${status}`;\n  const { setNodeRef, isOver } = useDroppable({ id: droppableId });\n\n  return (\n    <button\n      ref={setNodeRef}\n      type=\"button\"\n      onClick={onClick}\n      className={\n        [\n          \"shrink-0 rounded-full px-md py-sm text-sm\",\n          \"border border-border\",\n          \"transition\",\n          isActive ? \"bg-foreground text-background\" : \"bg-background text-foreground\",\n          isOver ? \"ring-2 ring-primary/40\" : \"\",\n        ].join(\" \")\n      }\n    >\n      {label}\n    </button>\n  );\n}\n\nexport function BoardColumns({ vm }: { vm: BoardVM }) {\n  const { t } = useTranslation();\n\n  const statuses = React.useMemo(\n    () =>\n      LOOP_MATCH_STATUSES.map((s) => ({\n        status: s.value as LoopMatchStatus,\n        title: t(`board.status.${s.value}`, s.label),\n      })),\n    [t],\n  );\n\n  const [activeStatus, setActiveStatus] = React.useState<LoopMatchStatus>(\n    (statuses[0]?.status ?? \"new\") as LoopMatchStatus,\n  );\n\n  const scrollerRef = React.useRef<HTMLDivElement | null>(null);\n  const colRefs = React.useRef<Record<string, HTMLDivElement | null>>({});\n  const setColRef = React.useCallback(\n    (status: LoopMatchStatus) => (el: HTMLDivElement | null) => {\n      colRefs.current[status] = el;\n    },\n    [],\n  );\n\n  const scrollToStatus = React.useCallback((status: LoopMatchStatus) => {\n    const el = colRefs.current[status];\n    if (!el) return;\n    el.scrollIntoView({ behavior: \"smooth\", inline: \"start\", block: \"nearest\" });\n  }, []);\n\n  const rafRef = React.useRef<number | null>(null);\n  const handleScrollerScroll = React.useCallback(() => {\n    if (rafRef.current) return;\n    rafRef.current = window.requestAnimationFrame(() => {\n      rafRef.current = null;\n      const scroller = scrollerRef.current;\n      if (!scroller) return;\n\n      // Find nearest column start relative to current scroll.\n      const left = scroller.scrollLeft;\n      let bestStatus: LoopMatchStatus = activeStatus;\n      let bestDist = Number.POSITIVE_INFINITY;\n      for (const { status } of statuses) {\n        const el = colRefs.current[status];\n        if (!el) continue;\n        const dist = Math.abs(el.offsetLeft - left);\n        if (dist < bestDist) {\n          bestDist = dist;\n          bestStatus = status;\n        }\n      }\n\n      if (bestStatus && bestStatus !== activeStatus) setActiveStatus(bestStatus);\n    });\n  }, [activeStatus, statuses]);\n\n  React.useEffect(() => {\n    return () => {\n      if (rafRef.current) window.cancelAnimationFrame(rafRef.current);\n    };\n  }, []);\n\n  const {\n    sensors,\n    columnsState,\n    activeMatch,\n    activeLoopName,\n    handleDragStart,\n    handleDragOver,\n    handleDragEnd,\n  } = useBoardColumnsDnd(vm);\n\n  return (\n    <DndContext\n      sensors={sensors}\n      collisionDetection={closestCorners}\n      onDragStart={handleDragStart}\n      onDragOver={handleDragOver}\n      onDragEnd={handleDragEnd}\n    >\n      <div className=\"h-full min-h-0 flex flex-col overflow-hidden\">\n        {/* Mobile: status tabs (also act as drop targets while dragging) */}\n        <div className=\"md:hidden shrink-0 px-md pb-sm\">\n          <div className=\"flex gap-sm overflow-x-auto no-scrollbar py-sm\">\n            {statuses.map(({ status, title }) => (\n              <StatusTabTarget\n                key={status}\n                status={status}\n                label={title}\n                isActive={activeStatus === status}\n                onClick={() => {\n                  setActiveStatus(status);\n                  scrollToStatus(status);\n                }}\n              />\n            ))}\n          </div>\n        </div>\n\n        {/* Columns scroller */}\n        <div\n          ref={scrollerRef}\n          onScroll={handleScrollerScroll}\n          className={\n            [\n              \"flex-1 min-h-0\",\n              \"overflow-x-auto overflow-y-hidden\",\n              // Mobile: Trello-like paging between columns\n              \"md:overflow-x-auto\",\n              \"snap-x snap-mandatory md:snap-none\",\n            ].join(\" \")\n          }\n        >\n          <div className=\"h-full min-h-0 flex items-stretch gap-md min-w-max px-md md:px-0\">\n            {statuses.map(({ status, title }) => {\n              const matches = columnsState.get(status) ?? [];\n              return (\n                <div key={status} ref={setColRef(status)} className=\"snap-start\">\n                  <BoardColumn\n                    status={status}\n                    title={title}\n                    matches={matches}\n                    loopIdToName={vm.data.loopIdToName}\n                    busy={vm.busy}\n                    onDelete={vm.actions.onDelete}\n                  />\n                </div>\n              );\n            })}\n          </div>\n        </div>\n      </div>\n\n      <DragOverlay adjustScale={false}>\n        {activeMatch ? (\n          <div className=\"w-[min(90vw,320px)]\">\n            <BoardMatchCardOverlay\n              match={activeMatch}\n              loopName={activeLoopName}\n              busy={vm.busy}\n              onDelete={vm.actions.onDelete}\n            />\n          </div>\n        ) : null}\n      </DragOverlay>\n    </DndContext>\n  );\n}\n","import {\n  PointerSensor,\n  TouchSensor,\n  useSensor,\n  useSensors,\n  type DragEndEvent,\n  type DragOverEvent,\n  type DragStartEvent,\n} from \"@dnd-kit/core\";\nimport React from \"react\";\n\nimport type { LoopMatch, LoopMatchStatus } from \"src/entities/loopMatch\";\n\nimport type { BoardDragPayload, BoardVM } from \"../../model/types\";\n\nimport {\n  buildColumnsFromVm,\n  cloneColumns,\n  findContainerOfId,\n  getLaneStatusFromOverId,\n  insertIntoList,\n  removeFromList,\n  type ColumnsState,\n} from \"./columnsState\";\n\nexport type UseBoardColumnsDndResult = Readonly<{\n  sensors: ReturnType<typeof useSensors>;\n  columnsState: ColumnsState;\n  activeId: string | null;\n  activeMatch: LoopMatch | null;\n  activeLoopName: string;\n  handleDragStart: (e: DragStartEvent) => void;\n  handleDragOver: (e: DragOverEvent) => void;\n  handleDragEnd: (e: DragEndEvent) => Promise<void>;\n}>;\n\nexport function useBoardColumnsDnd(vm: BoardVM): UseBoardColumnsDndResult {\n  const sensors = useSensors(\n    useSensor(PointerSensor, {\n      activationConstraint: { distance: 6 },\n    }),\n    // Mobile: allow normal scrolling; start drag only after a short long-press.\n    useSensor(TouchSensor, {\n      activationConstraint: { delay: 220, tolerance: 6 },\n    }),\n  );\n\n  const [columnsState, setColumnsState] = React.useState<ColumnsState>(() =>\n    buildColumnsFromVm(vm),\n  );\n  const [activeId, setActiveId] = React.useState<string | null>(null);\n\n\n  const pendingDropRef = React.useRef<\n    | {\n        matchId: string;\n        toStatus: LoopMatchStatus;\n        toIndex: number;\n      }\n    | null\n  >(null);\n\n  React.useEffect(() => {\n    if (activeId) return;\n\n    const pending = pendingDropRef.current;\n    if (pending) {\n      const list = vm.data.byStatus.get(pending.toStatus) ?? [];\n      const idx = list.findIndex((x) => x.id === pending.matchId);\n\n      const isAtTargetIndex =\n        idx === pending.toIndex ||\n        (pending.toIndex >= list.length && idx === list.length - 1);\n\n      if (idx === -1 || !isAtTargetIndex) return;\n      pendingDropRef.current = null;\n    }\n\n    setColumnsState(buildColumnsFromVm(vm));\n  }, [vm.data.byStatus, vm.data.matches, activeId, vm]);\n\n  const activeMatch = React.useMemo(() => {\n    if (!activeId) return null;\n    for (const list of columnsState.values()) {\n      const found = list.find((m) => m.id === activeId);\n      if (found) return found;\n    }\n    return null;\n  }, [activeId, columnsState]);\n\n  const activeLoopName = React.useMemo(() => {\n    if (!activeMatch) return \"\";\n    return vm.data.loopIdToName.get(activeMatch.loopId) ?? \"\";\n  }, [activeMatch, vm.data.loopIdToName]);\n\n  const dragFromRef = React.useRef<BoardDragPayload | null>(null);\n\n  const handleDragStart = React.useCallback(\n    (e: DragStartEvent) => {\n      const id = String(e.active.id);\n      setActiveId(id);\n\n      const fromStatus =\n        findContainerOfId(columnsState, id) ??\n        (activeMatch?.status as LoopMatchStatus | undefined);\n      const fromIndex = fromStatus\n        ? columnsState.get(fromStatus)?.findIndex((x) => x.id === id) ?? 0\n        : 0;\n\n      if (fromStatus) {\n        dragFromRef.current = { matchId: id, fromStatus, fromIndex };\n      } else {\n        dragFromRef.current = null;\n      }\n    },\n    [columnsState, activeMatch],\n  );\n\n  const handleDragOver = React.useCallback((e: DragOverEvent) => {\n    const { active, over } = e;\n    if (!over) return;\n\n    const activeIdStr = String(active.id);\n    const overIdStr = String(over.id);\n\n    const isBelowOverItem =\n      !!active.rect.current.translated &&\n      active.rect.current.translated.top > over.rect.top + over.rect.height / 2;\n    const overIndexModifier = isBelowOverItem ? 1 : 0;\n\n    setColumnsState((prev) => {\n      const next = cloneColumns(prev);\n\n      const fromStatus = findContainerOfId(next, activeIdStr);\n      if (!fromStatus) return prev;\n\n      const overLaneStatus = getLaneStatusFromOverId(overIdStr);\n      const overSortable = over.data.current?.sortable as\n        | { containerId: string; index: number }\n        | undefined;\n\n      const toStatus =\n        (overSortable?.containerId as LoopMatchStatus | undefined) ??\n        (overLaneStatus ??\n          (findContainerOfId(next, overIdStr) as LoopMatchStatus | null));\n\n      if (!toStatus) return prev;\n\n      const fromList = next.get(fromStatus) ?? [];\n      const toList = next.get(toStatus) ?? [];\n\n      const overIndexInTo =\n        typeof overSortable?.index === \"number\"\n          ? overSortable.index + overIndexModifier\n          : toList.length;\n\n      if (fromStatus === toStatus) {\n        const oldIndex = fromList.findIndex((x) => x.id === activeIdStr);\n        if (oldIndex === -1) return prev;\n\n        let newIndex = overIndexInTo;\n        if (newIndex > oldIndex) newIndex -= 1;\n\n        if (oldIndex === newIndex) return prev;\n\n        const { next: removed, item } = removeFromList(fromList, activeIdStr);\n        if (!item) return prev;\n\n        next.set(fromStatus, insertIntoList(removed, item, newIndex));\n        return next;\n      }\n\n      const { next: removedFrom, item } = removeFromList(fromList, activeIdStr);\n      if (!item) return prev;\n\n      next.set(fromStatus, removedFrom);\n      next.set(toStatus, insertIntoList(toList, item, overIndexInTo));\n      return next;\n    });\n  }, []);\n\n  const handleDragEnd = React.useCallback(\n    async (e: DragEndEvent) => {\n      const { active, over } = e;\n\n      const from = dragFromRef.current;\n      dragFromRef.current = null;\n      setActiveId(null);\n\n      if (!from) return;\n      if (!over) {\n        setColumnsState(buildColumnsFromVm(vm));\n        return;\n      }\n\n      const activeIdStr = String(active.id);\n\n      const toStatus = findContainerOfId(columnsState, activeIdStr);\n      if (!toStatus) {\n        setColumnsState(buildColumnsFromVm(vm));\n        return;\n      }\n\n      const toList = columnsState.get(toStatus) ?? [];\n      const toIndex = toList.findIndex((x) => x.id === activeIdStr);\n\n      pendingDropRef.current = {\n        matchId: activeIdStr,\n        toStatus,\n        toIndex: Math.max(0, toIndex),\n      };\n\n      try {\n        await vm.actions.onDropToStatus(\n          {\n            matchId: activeIdStr,\n            fromStatus: from.fromStatus,\n            fromIndex: from.fromIndex,\n          },\n          toStatus,\n          Math.max(0, toIndex),\n        );\n      } catch {\n        pendingDropRef.current = null;\n        setColumnsState(buildColumnsFromVm(vm));\n      }\n    },\n    [columnsState, vm],\n  );\n\n  return {\n    sensors,\n    columnsState,\n    activeId,\n    activeMatch,\n    activeLoopName,\n    handleDragStart,\n    handleDragOver,\n    handleDragEnd,\n  };\n}\n","import type { ReactNode } from \"react\";\nimport { useTranslation } from \"react-i18next\";\n\nimport { getErrorMessage } from \"src/shared/lib\";\nimport { PageMessage } from \"src/shared/ui\";\n\nimport type { BoardMatchesQueryState } from \"../model/types\";\n\ntype Props = Readonly<{\n  matchesQ: BoardMatchesQueryState;\n  isEmpty: boolean;\n  children: ReactNode;\n}>;\n\nexport function BoardState({ matchesQ, isEmpty, children }: Props) {\n  const { t } = useTranslation();\n\n  if (matchesQ.isLoading) {\n    return <PageMessage>{t(\"board.loading\", \"Loading matches…\")}</PageMessage>;\n  }\n\n  if (matchesQ.isError) {\n    return <PageMessage>{getErrorMessage(matchesQ.error)}</PageMessage>;\n  }\n\n  if (isEmpty) {\n    return <PageMessage>{t(\"board.empty\", \"No matches yet.\")}</PageMessage>;\n  }\n\n  return <>{children}</>;\n}\n","import { useTranslation } from \"react-i18next\";\n\nimport { PageHeader } from \"src/shared/ui\";\n\nimport { useBoardController } from \"./model/useBoardController\";\nimport { BoardColumns } from \"./ui/BoardColumns\";\nimport { BoardState } from \"./ui/BoardState\";\n\nexport default function BoardPage() {\n  const vm = useBoardController();\n  const { t } = useTranslation();\n\n  const matchesQ = vm.queries.matchesQ;\n  const isEmpty = vm.data.matches.length === 0;\n\n  const title = t(\"board.title\", \"Board\");\n  const subtitle = t(\"board.subtitle\", \"Drag matches between columns to update status.\");\n\n  return (\n    <div className=\"h-full min-h-0 flex flex-col overflow-hidden\">\n      <PageHeader title={title} subtitle={subtitle} />\n\n      <div className=\"flex-1 min-h-0 overflow-hidden\">\n        <BoardState matchesQ={matchesQ} isEmpty={isEmpty}>\n          <BoardColumns vm={vm} />\n        </BoardState>\n      </div>\n    </div>\n  );\n}\n"],"names":["storageKey","userId","isValidStatus","value","Set","LOOP_MATCH_STATUSES","map","s","String","has","createEmptyOrder","obj","loadOrder","raw","localStorage","getItem","parsed","JSON","parse","base","key","arr","Array","isArray","filter","x","saveOrder","order","setItem","stringify","sortByOrder","matches","orderIds","idx","Map","i","length","set","decorated","m","rank","id","get","Number","MAX_SAFE_INTEGER","stable","sort","a","b","useBoardController","useAuthSelectors","loops","matchesQ","loopsQ","useGetLoopsQuery","useGetAllMatchesQuery","React","data","isLoading","isError","error","useBoardQueries","loopIdToName","l","name","buildLoopIdToName","orderByStatus","applyDrop","params","setOrderByStatus","prev","next","existingIds","status","includes","push","ensureIdsExist","payload","toStatus","toIndex","fromArr","fromStatus","toArr","currentFromIndex","indexOf","matchId","splice","safeIndex","Math","max","min","useBoardOrderState","busy","onDeleteById","updateStatus","deleteMatchTrigger","deleteState","useDeleteMatchMutation","updateStatusTrigger","updateState","useUpdateMatchStatusMutation","Boolean","deleteMatch","async","args","match","find","loopId","useBoardMutations","byStatus","grouped","groupMatchesByStatus","ordered","buildBoardColumns","onDelete","catch","onDropToStatus","findMatchById","queries","actions","BoardLane","children","droppableId","setNodeRef","isOver","useDroppable","_jsx","ref","className","classNames","BoardMatchCardView","loopName","overlay","t","useTranslation","open","setOpen","onQuickDelete","e","preventDefault","stopPropagation","window","confirm","Promise","resolve","title","trim","company","matchedAt","formatMatchedAt","platform","p","normalizePlatform","toUpperCase","meta","location","v","join","url","hasUrl","onOpen","cursorClass","_jsxs","_Fragment","role","tabIndex","onClick","onKeyDown","Card","variant","padding","shadow","interactive","type","disabled","onPointerDown","Trash2","href","target","rel","MatchDetailsModal","onOpenChange","BoardMatchCard","index","attributes","listeners","transform","transition","isDragging","useSortable","style","CSS","Transform","toString","opacity","BoardMatchCardOverlay","BoardColumn","itemIds","SortableContext","items","strategy","verticalListSortingStrategy","buildColumnsFromVm","vm","findContainerOfId","state","list","entries","some","removeFromList","findIndex","item","slice","insertIntoList","StatusTabTarget","label","isActive","BoardColumns","statuses","activeStatus","setActiveStatus","scrollerRef","colRefs","setColRef","el","current","scrollToStatus","scrollIntoView","behavior","inline","block","rafRef","handleScrollerScroll","requestAnimationFrame","scroller","left","scrollLeft","bestStatus","bestDist","POSITIVE_INFINITY","dist","abs","offsetLeft","cancelAnimationFrame","sensors","columnsState","activeMatch","activeLoopName","handleDragStart","handleDragOver","handleDragEnd","useSensors","useSensor","PointerSensor","activationConstraint","distance","TouchSensor","delay","tolerance","setColumnsState","activeId","setActiveId","pendingDropRef","pending","isAtTargetIndex","values","found","dragFromRef","active","fromIndex","over","activeIdStr","overIdStr","overIndexModifier","rect","translated","top","height","src","k","cloneColumns","overLaneStatus","overId","startsWith","overSortable","sortable","containerId","fromList","toList","overIndexInTo","oldIndex","newIndex","removed","removedFrom","from","useBoardColumnsDnd","DndContext","collisionDetection","closestCorners","onDragStart","onDragOver","onDragEnd","onScroll","DragOverlay","adjustScale","BoardState","isEmpty","PageMessage","getErrorMessage","BoardPage","subtitle","PageHeader"],"ignoreList":[],"sourceRoot":""}