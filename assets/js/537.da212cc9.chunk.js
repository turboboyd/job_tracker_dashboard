"use strict";(self.webpackChunkjob_tracker_dashboard=self.webpackChunkjob_tracker_dashboard||[]).push([[537],{15019(e,t,a){a.d(t,{_H:()=>f,Xk:()=>v,g5:()=>m,$V:()=>x,LC:()=>g});var s=a(24589),r=a(80784),n=a(57616),i=a(42472);function o(e){return e instanceof Error?e.message:String(e)}function d(e){return{error:{message:e}}}function l(){return{iso:(new Date).toISOString(),server:(0,s.O5)()}}function c(e){const t=String(e??"").trim();return t?/^https?:\/\//i.test(t)?t:`https://${t}`:""}const u=n.q.injectEndpoints({endpoints:e=>({getAllMatches:e.query({async queryFn(e,t){try{const e=(0,i.j)(t.getState()),a=(0,s.P)((0,r.A9)(e),(0,s.My)("matchedAt","desc"));return{data:(await(0,s.GG)(a)).docs.map(e=>({id:e.id,...e.data()}))}}catch(e){return d(o(e))}},providesTags:e=>e?[...e.map(e=>({type:"LoopMatches",id:e.id})),{type:"LoopMatches",id:"LIST:ALL"}]:[{type:"LoopMatches",id:"LIST:ALL"}]}),getMatchesByLoop:e.query({async queryFn({loopId:e},t){try{const a=(0,i.j)(t.getState()),n=(0,s.P)((0,r.A9)(a),(0,s._M)("loopId","==",e),(0,s.My)("matchedAt","desc"));return{data:(await(0,s.GG)(n)).docs.map(e=>({id:e.id,...e.data()}))}}catch(e){return d(o(e))}},providesTags:(e,t,a)=>[{type:"LoopMatches",id:`LIST:LOOP:${a.loopId}`}]}),getMatch:e.query({async queryFn({matchId:e},t){try{const a=(0,i.j)(t.getState()),n=await(0,s.x7)((0,r.hM)(a,e));return n.exists()?{data:{id:n.id,...n.data()}}:{data:null}}catch(e){return d(o(e))}},providesTags:(e,t,a)=>[{type:"LoopMatches",id:a.matchId}]}),createMatch:e.mutation({async queryFn(e,t){try{const a=(0,i.j)(t.getState()),{iso:n,server:o}=l(),d={...e,url:c(e.url),createdAt:n,updatedAt:n,createdAtTs:o,updatedAtTs:o};return{data:{id:(await(0,s.gS)((0,r.A9)(a),d)).id}}}catch(e){return d(o(e))}},invalidatesTags:(e,t,a)=>[{type:"LoopMatches",id:"LIST:ALL"},{type:"LoopMatches",id:`LIST:LOOP:${a.loopId}`}]}),updateMatchStatus:e.mutation({async queryFn({matchId:e,status:t},a){try{const{iso:n,server:o}=l(),d=(0,i.j)(a.getState());return await(0,s.mZ)((0,r.hM)(d,e),{status:t,updatedAt:n,updatedAtTs:o}),{data:void 0}}catch(e){return d(o(e))}},invalidatesTags:(e,t,a)=>[{type:"LoopMatches",id:a.matchId},{type:"LoopMatches",id:"LIST:ALL"},{type:"LoopMatches",id:`LIST:LOOP:${a.loopId}`}]}),updateMatch:e.mutation({async queryFn({matchId:e,patch:t},a){try{const{iso:n,server:o}=l(),d=function(e){const t={...e};return"string"==typeof t.url&&(t.url=c(t.url)),t}(t),u=(0,i.j)(a.getState());return await(0,s.mZ)((0,r.hM)(u,e),{...d,updatedAt:n,updatedAtTs:o}),{data:void 0}}catch(e){return d(o(e))}},invalidatesTags:(e,t,a)=>[{type:"LoopMatches",id:a.matchId},{type:"LoopMatches",id:"LIST:ALL"}]}),deleteMatch:e.mutation({async queryFn({matchId:e},t){try{const a=(0,i.j)(t.getState());return await(0,s.kd)((0,r.hM)(a,e)),{data:void 0}}catch(e){return d(o(e))}},invalidatesTags:(e,t,a)=>[{type:"LoopMatches",id:a.matchId},{type:"LoopMatches",id:"LIST:ALL"},{type:"LoopMatches",id:`LIST:LOOP:${a.loopId}`}]})})}),{useGetAllMatchesQuery:m,useGetMatchesByLoopQuery:p,useGetMatchQuery:h,useCreateMatchMutation:f,useUpdateMatchStatusMutation:g,useUpdateMatchMutation:x,useDeleteMatchMutation:v}=u;a(65546)},30537(e,t,a){a.d(t,{Cq:()=>h,B6:()=>x,v:()=>u,FL:()=>c,Xk:()=>s.Xk,g5:()=>s.g5,$V:()=>s.$V,LC:()=>s.LC});var s=a(15019),r=(a(65546),a(96540)),n=a(22022),i=a(99653),o=a(68701),d=a(61239);const l=new Set(d.Aj.map(e=>e.id));function c(e){if("string"!=typeof e)return"";const t=e.trim().toLowerCase();return t&&l.has(t)?t:""}function u(e){if(!e)return"";const t=new Date(e);if(Number.isNaN(t.getTime()))return e;const a=String(t.getFullYear()),s=String(t.getMonth()+1).padStart(2,"0");return`${String(t.getDate()).padStart(2,"0")}.${s}.${a}`}var m=a(74848);const p=["new","saved","interview","offer","applied","rejected"];function h({match:e,loopName:t,busy:a,onUpdateStatus:s,onDelete:d,onEdit:l}){const{t:h}=(0,n.Bd)(),g=r.useMemo(()=>u(e.matchedAt),[e.matchedAt]),x=r.useMemo(()=>{const t=c(e.platform);return t?t.toUpperCase():""},[e.platform]),v=r.useMemo(()=>[e.location,x,g,t].map(e=>String(e??"").trim()).filter(Boolean).join(" • "),[e.location,x,g,t]);return(0,m.jsxs)(o.Zp,{variant:"default",padding:"md",shadow:"sm",className:"flex flex-col gap-sm",children:[(0,m.jsxs)("div",{className:"flex items-start justify-between gap-md",children:[(0,m.jsxs)("div",{className:"min-w-0",children:[(0,m.jsxs)("div",{className:"min-w-0 whitespace-nowrap overflow-hidden text-ellipsis text-sm",children:[(0,m.jsx)("span",{className:"font-semibold text-foreground",children:e.title||"—"}),(0,m.jsx)("span",{className:"ml-2 text-muted-foreground",children:e.company||"—"})]}),v?(0,m.jsx)("div",{className:"mt-1 text-xs text-muted-foreground whitespace-nowrap overflow-hidden text-ellipsis",children:v}):null]}),(0,m.jsx)("div",{className:"flex items-center gap-sm",children:(0,m.jsx)(f,{value:e.status})})]}),(0,m.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-sm pt-xs",children:[(0,m.jsxs)("label",{className:"flex items-center gap-sm text-sm",children:[(0,m.jsx)("span",{className:"text-muted-foreground",children:h("matches.common.status")}),(0,m.jsx)("select",{value:e.status,disabled:a,onChange:t=>s(e.id,t.target.value),className:(0,i.xW)("h-9 rounded-full px-sm","border border-border bg-card text-foreground","focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background"),children:p.map(e=>(0,m.jsx)("option",{value:e,children:h(`matches.status.${e}`)},e))})]}),(0,m.jsxs)("div",{className:"flex items-center gap-sm",children:[l?(0,m.jsx)(o.$n,{variant:"outline",size:"sm",shape:"pill",disabled:a,onClick:()=>l(e.id),children:h("matches.common.edit")}):null,(0,m.jsx)(o.$n,{variant:"outline",size:"sm",shape:"pill",disabled:a,onClick:()=>d(e.id),children:h("matches.common.delete")})]})]})]})}function f({value:e}){const{t}=(0,n.Bd)();return(0,m.jsx)("span",{className:(0,i.xW)("inline-flex items-center","rounded-full px-sm py-[2px]","text-xs font-medium",g(e)),children:t(`matches.status.${e}`)})}function g(e){switch(e){case"new":return"bg-info text-info-foreground";case"saved":return"bg-secondary text-secondary-foreground";case"applied":default:return"bg-muted text-foreground";case"interview":return"bg-warning text-warning-foreground";case"offer":return"bg-success text-success-foreground";case"rejected":return"bg-destructive text-destructive-foreground"}}function x({open:e,onOpenChange:t,match:a,loopName:s,busy:d,onDelete:l,onUpdateStatus:p,onEdit:h}){const{t:f}=(0,n.Bd)(),g=r.useMemo(()=>u(a.matchedAt),[a.matchedAt]),x=r.useMemo(()=>{const e=c(a.platform);return e?e.toUpperCase():""},[a.platform]),j=r.useMemo(()=>[a.location,x,g,s].map(e=>String(e??"").trim()).filter(Boolean).join(" • "),[a.location,x,g,s]),y=r.useMemo(()=>f(`matches.status.${a.status}`,{defaultValue:a.status}),[a.status,f]),M=r.useMemo(()=>String(a.title??"").trim()||f("matches.details.untitled",{defaultValue:"Match"}),[a.title,f]),L=r.useMemo(()=>String(a.url??"").trim(),[a.url]),w=Boolean(L),S=r.useMemo(()=>String(a.description??"").trim(),[a.description]),N=Boolean(S);return(0,m.jsx)(o.aF,{open:e,onOpenChange:t,title:M,description:j||void 0,size:"md",children:(0,m.jsxs)("div",{className:"flex flex-col gap-lg",children:[(0,m.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-md",children:[(0,m.jsx)(v,{label:f("matches.fields.location",{defaultValue:"Location"}),value:a.location}),(0,m.jsx)(v,{label:f("matches.fields.platform",{defaultValue:"Platform"}),value:x}),(0,m.jsx)(v,{label:f("matches.fields.matchedAt",{defaultValue:"Matched"}),value:g}),(0,m.jsx)(v,{label:f("matches.fields.loop",{defaultValue:"Loop"}),value:s})]}),(0,m.jsxs)("div",{children:[(0,m.jsx)("div",{className:"text-sm font-semibold text-foreground",children:f("matches.fields.description",{defaultValue:"Description"})}),(0,m.jsx)("div",{className:(0,i.xW)("mt-2 rounded-xl border border-border bg-card p-md","text-sm leading-relaxed whitespace-pre-wrap",!N&&"text-muted-foreground"),children:N?S:f("matches.details.noDescription",{defaultValue:"No description."})})]}),(0,m.jsxs)("div",{className:(0,i.xW)("flex flex-wrap items-center justify-end gap-sm pt-sm"),children:[(0,m.jsx)("span",{className:"mr-auto rounded-full border border-border bg-card px-sm py-1 text-xs text-muted-foreground",children:y}),w?(0,m.jsx)(o.$n,{asChild:!0,variant:"outline",size:"sm",shape:"pill",disabled:d,children:(0,m.jsx)("a",{href:L,target:"_blank",rel:"noreferrer",children:f("matches.common.openLink",{defaultValue:"Open link"})})}):null,p?(0,m.jsx)(b,{value:a.status,disabled:d,onChange:e=>p(a.id,e)}):null,h?(0,m.jsx)(o.$n,{variant:"outline",size:"sm",shape:"pill",disabled:d,onClick:()=>h(a.id),children:f("matches.common.edit",{defaultValue:"Edit"})}):null,(0,m.jsx)(o.$n,{variant:"outline",size:"sm",shape:"pill",disabled:d,onClick:()=>l(a.id),children:f("matches.common.delete",{defaultValue:"Delete"})})]})]})})}function v({label:e,value:t}){const a=String(t??"").trim();return(0,m.jsxs)("div",{className:"rounded-xl border border-border bg-card p-md",children:[(0,m.jsx)("div",{className:"text-xs text-muted-foreground",children:e}),(0,m.jsx)("div",{className:"mt-1 text-sm font-medium text-foreground whitespace-nowrap overflow-hidden text-ellipsis",children:a||"—"})]})}function b({value:e,disabled:t,onChange:a}){const{t:s}=(0,n.Bd)();return(0,m.jsxs)("label",{className:"flex items-center gap-sm text-sm",children:[(0,m.jsx)("span",{className:"text-muted-foreground",children:s("matches.common.status",{defaultValue:"Status"})}),(0,m.jsx)("select",{value:e,disabled:t,onChange:e=>a(e.target.value),className:(0,i.xW)("h-9 rounded-full px-sm","border border-border bg-card text-foreground","focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background"),children:["new","saved","interview","offer","applied","rejected"].map(e=>(0,m.jsx)("option",{value:e,children:s(`matches.status.${e}`,{defaultValue:e})},e))})]})}},65546(e,t,a){a(24589),a(80784)}}]);
//# sourceMappingURL=537.da212cc9.chunk.js.map