"use strict";(self.webpackChunkjob_tracker_dashboard=self.webpackChunkjob_tracker_dashboard||[]).push([[4012],{338(e,o,a){function t(e,o,a,t={replace:!0}){const l=new URLSearchParams(o.search);for(const[e,o]of Object.entries(a))null!=o&&!1!==o?!0!==o?l.set(e,String(o)):l.set(e,"1"):l.delete(e);const r=l.toString();e({pathname:o.pathname,search:r?`?${r}`:""},{replace:t.replace??!0})}a.d(o,{N:()=>t})},15019(e,o,a){a.d(o,{_H:()=>g,Xk:()=>b,g5:()=>p,$V:()=>x,LC:()=>f});var t=a(24589),l=a(80784),r=a(57616),s=a(42472);function n(e){return e instanceof Error?e.message:String(e)}function i(e){return{error:{message:e}}}function d(){return{iso:(new Date).toISOString(),server:(0,t.O5)()}}function c(e){const o=String(e??"").trim();return o?/^https?:\/\//i.test(o)?o:`https://${o}`:""}const u=r.q.injectEndpoints({endpoints:e=>({getAllMatches:e.query({async queryFn(e,o){try{const e=(0,s.j)(o.getState()),a=(0,t.P)((0,l.A9)(e),(0,t.My)("matchedAt","desc"));return{data:(await(0,t.GG)(a)).docs.map(e=>({id:e.id,...e.data()}))}}catch(e){return i(n(e))}},providesTags:e=>e?[...e.map(e=>({type:"LoopMatches",id:e.id})),{type:"LoopMatches",id:"LIST:ALL"}]:[{type:"LoopMatches",id:"LIST:ALL"}]}),getMatchesByLoop:e.query({async queryFn({loopId:e},o){try{const a=(0,s.j)(o.getState()),r=(0,t.P)((0,l.A9)(a),(0,t._M)("loopId","==",e),(0,t.My)("matchedAt","desc"));return{data:(await(0,t.GG)(r)).docs.map(e=>({id:e.id,...e.data()}))}}catch(e){return i(n(e))}},providesTags:(e,o,a)=>[{type:"LoopMatches",id:`LIST:LOOP:${a.loopId}`}]}),getMatch:e.query({async queryFn({matchId:e},o){try{const a=(0,s.j)(o.getState()),r=await(0,t.x7)((0,l.hM)(a,e));return r.exists()?{data:{id:r.id,...r.data()}}:{data:null}}catch(e){return i(n(e))}},providesTags:(e,o,a)=>[{type:"LoopMatches",id:a.matchId}]}),createMatch:e.mutation({async queryFn(e,o){try{const a=(0,s.j)(o.getState()),{iso:r,server:n}=d(),i={...e,url:c(e.url),createdAt:r,updatedAt:r,createdAtTs:n,updatedAtTs:n};return{data:{id:(await(0,t.gS)((0,l.A9)(a),i)).id}}}catch(e){return i(n(e))}},invalidatesTags:(e,o,a)=>[{type:"LoopMatches",id:"LIST:ALL"},{type:"LoopMatches",id:`LIST:LOOP:${a.loopId}`}]}),updateMatchStatus:e.mutation({async queryFn({matchId:e,status:o},a){try{const{iso:r,server:n}=d(),i=(0,s.j)(a.getState());return await(0,t.mZ)((0,l.hM)(i,e),{status:o,updatedAt:r,updatedAtTs:n}),{data:void 0}}catch(e){return i(n(e))}},invalidatesTags:(e,o,a)=>[{type:"LoopMatches",id:a.matchId},{type:"LoopMatches",id:"LIST:ALL"},{type:"LoopMatches",id:`LIST:LOOP:${a.loopId}`}]}),updateMatch:e.mutation({async queryFn({matchId:e,patch:o},a){try{const{iso:r,server:n}=d(),i=function(e){const o={...e};return"string"==typeof o.url&&(o.url=c(o.url)),o}(o),u=(0,s.j)(a.getState());return await(0,t.mZ)((0,l.hM)(u,e),{...i,updatedAt:r,updatedAtTs:n}),{data:void 0}}catch(e){return i(n(e))}},invalidatesTags:(e,o,a)=>[{type:"LoopMatches",id:a.matchId},{type:"LoopMatches",id:"LIST:ALL"}]}),deleteMatch:e.mutation({async queryFn({matchId:e},o){try{const a=(0,s.j)(o.getState());return await(0,t.kd)((0,l.hM)(a,e)),{data:void 0}}catch(e){return i(n(e))}},invalidatesTags:(e,o,a)=>[{type:"LoopMatches",id:a.matchId},{type:"LoopMatches",id:"LIST:ALL"},{type:"LoopMatches",id:`LIST:LOOP:${a.loopId}`}]})})}),{useGetAllMatchesQuery:p,useGetMatchesByLoopQuery:m,useGetMatchQuery:h,useCreateMatchMutation:g,useUpdateMatchStatusMutation:f,useUpdateMatchMutation:x,useDeleteMatchMutation:b}=u;a(65546)},24012(e,o,a){a.r(o),a.d(o,{default:()=>Z});var t=a(22022),l=a(3433),r=a(55689),s=a(68701),n=a(96540),i=a(74848);function d({title:e,subtitle:o,right:a}){return(0,i.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:"text-2xl font-semibold text-foreground",children:e}),o?(0,i.jsx)("div",{className:"mt-1 text-sm text-muted-foreground",children:o}):null]}),a]})}function c({children:e}){return(0,i.jsx)("div",{className:"rounded-2xl border border-border bg-card p-6 text-sm text-muted-foreground",children:e})}var u=a(43578),p=a(14603),m=a(82284);function h(e){return"object"==typeof e&&null!==e}function g(e,o){return"string"==typeof e?e:o}function f(e,o){const a="number"==typeof e?e:Number(e);return Number.isFinite(a)?a:o}function x(e,o,a){return o.includes(e)?e:a}function b(e){return e.map(e=>String(e??"").trim()).filter(Boolean).join(" OR ")}a(56258);var v=a(99653),y=a(95531),j=a(7425),w=a(12664),N=a(15019),M=a(82207);const k=[{needle:"linkedin.com",platform:"linkedin"},{needle:"indeed.",platform:"indeed"},{needle:"glassdoor.",platform:"glassdoor"},{needle:"monster.",platform:"monster"},{needle:"stepstone.",platform:"stepstone"},{needle:"xing.",platform:"xing"},{needle:"github.com",platform:"github"},{needle:"wellfound.",platform:"wellfound"},{needle:"angel.co",platform:"wellfound"},{needle:"levels.fyi",platform:"levels"}];var L=a(95310);const C=L.WI.map(e=>e.value),S=L.YN.map(e=>e.value);function B({open:e,onOpenChange:o,loopId:a,defaultPlatform:l}){const{t:r}=(0,t.Bd)(),[d,c]=(0,N._H)(),u=(0,n.useMemo)(()=>function(e){return w.Ik({title:w.Yj().trim().min(2,e("loops.validation.titleRequired",{defaultValue:"Title is required"})).required(e("loops.validation.titleRequired",{defaultValue:"Title is required"})),company:w.Yj().trim().min(2,e("loops.validation.companyRequired",{defaultValue:"Company is required"})).required(e("loops.validation.companyRequired",{defaultValue:"Company is required"})),location:w.Yj().trim().min(2,e("loops.validation.locationRequired",{defaultValue:"Location is required"})).required(e("loops.validation.locationRequired",{defaultValue:"Location is required"})),platform:w.gl().oneOf(C).required(e("loops.validation.platformRequired",{defaultValue:"Platform is required"})),url:w.Yj().trim().required(e("loops.validation.urlRequired",{defaultValue:"Job URL is required"})).test("is-url",e("loops.validation.invalidUrl",{defaultValue:"Invalid URL"}),e=>Boolean(function(e){const o=e.trim();if(!o)return null;try{return new URL(o)}catch{try{return new URL(`https://${o}`)}catch{return null}}}(e??""))),description:w.Yj().trim().min(1,e("loops.validation.descriptionRequired",{defaultValue:"Description is required"})).required(e("loops.validation.descriptionRequired",{defaultValue:"Description is required"})),status:w.gl().oneOf(S).required(e("loops.validation.statusRequired",{defaultValue:"Status is required"})),matchedAt:w.Yj().trim().required()})}(r),[r]),p=(0,n.useMemo)(()=>{return{title:"",company:"",location:"",platform:(e=l,e??"linkedin"),url:"",description:"",status:"new",matchedAt:(new Date).toISOString()};var e},[l]),m=c.isLoading;return(0,i.jsx)(s.aF,{open:e,onOpenChange:o,title:r("loops.addMatch",{defaultValue:"Add match"}),description:r("loops.addMatchDescription",{defaultValue:"Paste the job URL and fill details. This saves a match to your loop."}),children:(0,i.jsx)(j.l1,{initialValues:p,enableReinitialize:!0,validationSchema:u,onSubmit:async(e,t)=>{t.setStatus(void 0);try{await d({loopId:a,title:e.title,company:e.company,location:e.location,platform:e.platform,url:e.url,description:e.description,status:e.status,matchedAt:e.matchedAt}).unwrap(),o(!1)}catch(e){t.setStatus((0,v.u1)(e)||r("loops.failedToSaveMatch",{defaultValue:"Failed to save match"}))}},children:e=>{const a=("string"==typeof e.status?e.status:void 0)||(c.isError?(0,v.u1)(c.error):void 0),t=!m&&e.dirty;return(0,i.jsxs)("form",{onSubmit:e.handleSubmit,className:"space-y-4",children:[a?(0,i.jsx)(s.Wz,{message:a}):null,(0,i.jsxs)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[(0,i.jsx)(M.z,{label:r("loops.jobTitle",{defaultValue:"Job title"}),required:!0,error:e.touched.title?e.errors.title:void 0,children:({id:o,describedBy:a,invalid:t})=>(0,i.jsx)(s.pd,{id:o,name:"title",value:e.values.title,onChange:e.handleChange,onBlur:e.handleBlur,placeholder:r("loops.jobTitlePlaceholder",{defaultValue:"Frontend Developer"}),state:t?"error":"default","aria-invalid":t,"aria-describedby":a,disabled:m})}),(0,i.jsx)(M.z,{label:r("loops.company",{defaultValue:"Company"}),required:!0,error:e.touched.company?e.errors.company:void 0,children:({id:o,describedBy:a,invalid:t})=>(0,i.jsx)(s.pd,{id:o,name:"company",value:e.values.company,onChange:e.handleChange,onBlur:e.handleBlur,placeholder:r("loops.companyPlaceholder",{defaultValue:"Acme GmbH"}),state:t?"error":"default","aria-invalid":t,"aria-describedby":a,disabled:m})}),(0,i.jsx)(M.z,{label:r("loops.location",{defaultValue:"Location"}),required:!0,error:e.touched.location?e.errors.location:void 0,children:({id:o,describedBy:a,invalid:t})=>(0,i.jsx)(s.pd,{id:o,name:"location",value:e.values.location,onChange:e.handleChange,onBlur:e.handleBlur,placeholder:r("loops.locationJobPlaceholder",{defaultValue:"Berlin / Remote"}),state:t?"error":"default","aria-invalid":t,"aria-describedby":a,disabled:m})}),(0,i.jsx)(M.z,{label:r("loops.platform",{defaultValue:"Platform"}),required:!0,children:({id:o,describedBy:a})=>(0,i.jsx)("select",{id:o,name:"platform",value:e.values.platform,onChange:e.handleChange,onBlur:e.handleBlur,"aria-describedby":a,disabled:m,className:"h-10 w-full rounded-xl border border-border bg-input px-3 text-sm text-foreground",children:L.WI.map(e=>(0,i.jsx)("option",{value:e.value,children:e.label},e.value))})}),(0,i.jsx)(M.z,{label:r("loops.jobUrl",{defaultValue:"Job URL"}),required:!0,hint:r("loops.jobUrlHint",{defaultValue:"You can paste without https:// (it will be normalized on save)."}),error:e.touched.url?e.errors.url:void 0,children:({id:o,describedBy:a,invalid:t})=>(0,i.jsx)(s.pd,{id:o,name:"url",value:e.values.url,onChange:o=>{const a=o.target.value;e.setFieldValue("url",a);const t=function(e){if(!e)return"other";let o="";try{o=new URL(e).host.toLowerCase()}catch{return"other"}for(const e of k)if(o.includes(e.needle))return e.platform;return"other"}(a);t&&e.setFieldValue("platform",t)},onBlur:e.handleBlur,placeholder:r("loops.jobUrlPlaceholder",{defaultValue:"company.com/job"}),state:t?"error":"default","aria-invalid":t,"aria-describedby":a,disabled:m})}),(0,i.jsx)(M.z,{label:r("loops.status",{defaultValue:"Status"}),required:!0,children:({id:o,describedBy:a})=>(0,i.jsx)("select",{id:o,name:"status",value:e.values.status,onChange:e.handleChange,onBlur:e.handleBlur,"aria-describedby":a,disabled:m,className:"h-10 w-full rounded-xl border border-border bg-input px-3 text-sm text-foreground",children:L.YN.map(e=>(0,i.jsx)("option",{value:e.value,children:r(`loops.status.${e.value}`,{defaultValue:e.label})},e.value))})})]}),(0,i.jsx)(M.z,{label:r("loops.description",{defaultValue:"Description"}),required:!0,error:e.touched.description?e.errors.description:void 0,children:({id:o,describedBy:a,invalid:t})=>(0,i.jsx)(s.fs,{id:o,name:"description",value:e.values.description,onChange:e.handleChange,onBlur:e.handleBlur,placeholder:r("loops.descriptionPlaceholder",{defaultValue:"Paste key parts of the job description here…"}),state:t?"error":"default","aria-invalid":t,"aria-describedby":a,disabled:m})}),(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(s.$n,{type:"submit",variant:"default",shadow:"sm",shape:"lg",disabled:!t,children:m?r("loops.saving",{defaultValue:"Saving..."}):r("loops.saveMatch",{defaultValue:"Save match"})}),(0,i.jsx)(s.$n,{type:"button",variant:"outline",shape:"lg",onClick:()=>o(!1),disabled:m,children:r("loops.cancel",{defaultValue:"Cancel"})})]})]})}})})}function A(e){const o=new Set;for(const a of e)o.add(a);return Array.from(o)}function I({open:e,onOpenChange:o,value:a,disabled:l,onSave:r}){const{t:d}=(0,t.Bd)(),[c,u]=(0,n.useState)(()=>A(a??[])),[p,h]=(0,n.useState)(!1);(0,n.useEffect)(()=>{e&&u(A(a??[]))},[e,a]);const g=(0,n.useMemo)(()=>new Set(c),[c]),f=c.length,x=!l&&!p;return(0,i.jsx)(s.aF,{open:e,onOpenChange:o,title:d("loops.editSources","Edit sources"),description:d("loops.editSourcesDescription","Choose job boards/platforms. This controls which search links are generated."),size:"lg",children:(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[(0,i.jsxs)("div",{className:"text-sm text-muted-foreground",children:[d("loops.selected","Selected"),": "," ",(0,i.jsx)("span",{className:"font-medium text-foreground",children:f})]}),(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(s.$n,{variant:"outline",shape:"lg",onClick:()=>u(m.Rx),disabled:l||p,children:d("loops.recommended","Recommended")}),(0,i.jsx)(s.$n,{variant:"outline",shape:"lg",onClick:()=>u(m.VT),disabled:l||p,children:d("loops.selectAll","Select all")})]})]}),(0,i.jsxs)("div",{className:"rounded-2xl border border-border bg-background p-4 space-y-3",children:[(0,i.jsx)("div",{className:"text-sm font-semibold text-foreground",children:d("loops.groups","Groups")}),(0,i.jsx)("div",{className:"flex flex-wrap gap-2",children:m.fd.map(e=>{const o=(0,m.zV)(e.id),a=o.filter(e=>g.has(e)).length,t=a===o.length&&o.length>0;return(0,i.jsxs)("button",{type:"button",onClick:()=>(e=>{const o=(0,m.zV)(e);u(e=>{const a=new Set(e);if(o.every(e=>a.has(e)))for(const e of o)a.delete(e);else for(const e of o)a.add(e);return Array.from(a)})})(e.id),disabled:l||p,className:["inline-flex items-center gap-2 rounded-full border px-3 py-1 text-xs transition-colors",t?"border-primary/50 bg-primary/10 text-foreground":"border-border bg-card text-muted-foreground",l||p?"opacity-50 cursor-not-allowed":"hover:bg-muted/40"].join(" "),children:[(0,i.jsx)("span",{className:"font-medium",children:e.title}),(0,i.jsxs)("span",{className:"text-[11px] text-muted-foreground",children:[a,"/",o.length]})]},e.id)})})]}),(0,i.jsxs)("div",{className:"rounded-2xl border border-border bg-background p-4 space-y-3",children:[(0,i.jsx)("div",{className:"text-sm font-semibold text-foreground",children:d("loops.platforms","Platforms")}),(0,i.jsx)("div",{className:"grid grid-cols-1 gap-2 md:grid-cols-2",children:(b=m.VT,[...b].sort((e,o)=>{const a=m.Jf[e]??e,t=m.Jf[o]??o;return a.localeCompare(t)})).map(e=>{const o=g.has(e),a=m.Jf[e]??e;return(0,i.jsxs)("label",{className:["flex items-center gap-3 rounded-xl border px-3 py-2 text-sm",o?"border-primary/40 bg-primary/5":"border-border bg-card",l||p?"opacity-50 cursor-not-allowed":"hover:bg-muted/30"].join(" "),children:[(0,i.jsx)("input",{type:"checkbox",checked:o,onChange:()=>(e=>{u(o=>{const a=new Set(o);return a.has(e)?a.delete(e):a.add(e),Array.from(a)})})(e),disabled:l||p}),(0,i.jsx)("span",{className:"text-foreground",children:a})]},e)})})]}),(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(s.$n,{variant:"default",shadow:"sm",shape:"lg",onClick:async function(){h(!0);try{await r(A(c)),o(!1)}finally{h(!1)}},disabled:!x,children:p?d("loops.saving","Saving..."):d("loops.save","Save")}),(0,i.jsx)(s.$n,{variant:"outline",shape:"lg",onClick:()=>o(!1),disabled:l||p,children:d("loops.cancel","Cancel")})]})]})});var b}const V=[5,10,20,30,50,100],R=[1,3,7,14,30];function q(e){return e.replace(/\s+/g," ").trim()}function T({value:e,onChange:o,onApply:a,onReset:l,disabled:r}){const{t:d}=(0,t.Bd)(),[c,u]=(0,n.useState)(!1),p=(0,n.useMemo)(()=>[{value:"any",label:d("loops.workMode.any","Any")},{value:"onsite",label:d("loops.workMode.onsite","On-site")},{value:"hybrid",label:d("loops.workMode.hybrid","Hybrid")},{value:"remote",label:d("loops.workMode.remote","Remote")},{value:"remote_only",label:d("loops.workMode.remoteOnly","Remote-only")}],[d]),m=(0,n.useMemo)(()=>[{value:"intern",label:d("loops.seniority.intern","Intern")},{value:"junior",label:d("loops.seniority.junior","Junior")},{value:"mid",label:d("loops.seniority.mid","Mid")},{value:"senior",label:d("loops.seniority.senior","Senior")},{value:"lead",label:d("loops.seniority.lead","Lead")}],[d]),h=(0,n.useMemo)(()=>[{value:"full_time",label:d("loops.employment.fullTime","Full-time")},{value:"part_time",label:d("loops.employment.partTime","Part-time")},{value:"contract",label:d("loops.employment.contract","Contract")},{value:"internship",label:d("loops.employment.internship","Internship")},{value:"ausbildung",label:d("loops.employment.ausbildung","Ausbildung")}],[d]),g=(0,n.useMemo)(()=>[{value:"any",label:d("loops.language.any","Any")},{value:"de",label:d("loops.language.de","DE")},{value:"en",label:d("loops.language.en","EN")}],[d]),f=(0,n.useMemo)(()=>{const o=[],a=e.role.trim(),t=e.location.trim();return a&&o.push(d("loops.badgeRole","Role: {{value}}",{value:a})),t&&o.push(d("loops.badgeLoc","Loc: {{value}}",{value:t})),o.push(d("loops.badgeRadius","Radius: {{value}}km",{value:e.radiusKm})),"any"!==e.workMode&&o.push(d("loops.badgeMode","Mode: {{value}}",{value:e.workMode})),o.push(d("loops.badgePosted","Posted: {{value}}d",{value:e.postedWithin})),o},[d,e]);return(0,i.jsxs)("div",{className:"rounded-2xl border border-border bg-card p-6 space-y-4",children:[(0,i.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:"text-base font-semibold text-foreground",children:d("loops.filtersTitle","Filters")}),(0,i.jsx)("div",{className:"mt-1 text-sm text-muted-foreground",children:d("loops.filtersSubtitle","Update → Apply → links refresh & saved to loop.")}),f.length?(0,i.jsx)("div",{className:"mt-2 flex flex-wrap gap-2",children:f.map(e=>(0,i.jsx)("span",{className:"rounded-full border border-border bg-background px-3 py-1 text-xs text-muted-foreground",children:e},e))}):null]}),(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(s.$n,{variant:"default",shadow:"sm",shape:"lg",onClick:a,disabled:r,children:d("loops.apply","Apply")}),(0,i.jsx)(s.$n,{variant:"outline",shape:"lg",onClick:l,disabled:r,children:d("loops.reset","Reset")})]})]}),(0,i.jsxs)("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-12",children:[(0,i.jsx)("div",{className:"md:col-span-5",children:(0,i.jsx)(s.zB,{label:d("loops.professionRole","Profession / Role"),children:(0,i.jsx)(s.pd,{value:e.role,onChange:a=>o({...e,role:a.target.value}),placeholder:d("loops.professionRolePlaceholder","Fachinformatiker OR React Developer"),disabled:r})})}),(0,i.jsx)("div",{className:"md:col-span-4",children:(0,i.jsx)(s.zB,{label:d("loops.location","Location"),children:(0,i.jsx)(s.pd,{value:e.location,onChange:a=>o({...e,location:a.target.value}),placeholder:d("loops.locationPlaceholder","Berlin"),disabled:r})})}),(0,i.jsx)("div",{className:"md:col-span-2",children:(0,i.jsx)(s.zB,{label:d("loops.radius","Radius"),children:(0,i.jsx)("select",{value:e.radiusKm,onChange:a=>o({...e,radiusKm:Number(a.target.value)}),className:"h-10 w-full rounded-xl border border-border bg-input px-3 text-sm text-foreground",disabled:r,children:V.map(e=>(0,i.jsx)("option",{value:e,children:d("loops.km","{{value}} km",{value:e})},e))})})}),(0,i.jsx)("div",{className:"md:col-span-1",children:(0,i.jsx)(s.zB,{label:" ",hint:"",children:(0,i.jsx)(s.$n,{variant:"outline",shape:"lg",className:"w-full",onClick:()=>u(e=>!e),disabled:r,children:c?d("loops.less","Less"):d("loops.more","More")})})})]}),c?(0,i.jsxs)("div",{className:"rounded-2xl border border-border bg-background p-4 space-y-4",children:[(0,i.jsxs)("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-12",children:[(0,i.jsx)("div",{className:"md:col-span-3",children:(0,i.jsx)(s.zB,{label:d("loops.workModeTitle","Work mode"),children:(0,i.jsx)("select",{value:e.workMode,onChange:a=>o({...e,workMode:a.target.value}),className:"h-10 w-full rounded-xl border border-border bg-card px-3 text-sm text-foreground",disabled:r,children:p.map(e=>(0,i.jsx)("option",{value:e.value,children:e.label},e.value))})})}),(0,i.jsx)("div",{className:"md:col-span-3",children:(0,i.jsx)(s.zB,{label:d("loops.seniorityTitle","Seniority"),children:(0,i.jsx)("select",{value:e.seniority,onChange:a=>o({...e,seniority:a.target.value}),className:"h-10 w-full rounded-xl border border-border bg-card px-3 text-sm text-foreground",disabled:r,children:m.map(e=>(0,i.jsx)("option",{value:e.value,children:e.label},e.value))})})}),(0,i.jsx)("div",{className:"md:col-span-3",children:(0,i.jsx)(s.zB,{label:d("loops.employmentType","Employment type"),children:(0,i.jsx)("select",{value:e.employmentType,onChange:a=>o({...e,employmentType:a.target.value}),className:"h-10 w-full rounded-xl border border-border bg-card px-3 text-sm text-foreground",disabled:r,children:h.map(e=>(0,i.jsx)("option",{value:e.value,children:e.label},e.value))})})}),(0,i.jsx)("div",{className:"md:col-span-3",children:(0,i.jsx)(s.zB,{label:d("loops.postedWithin","Posted within"),children:(0,i.jsx)("select",{value:e.postedWithin,onChange:a=>o({...e,postedWithin:Number(a.target.value)}),className:"h-10 w-full rounded-xl border border-border bg-card px-3 text-sm text-foreground",disabled:r,children:R.map(e=>(0,i.jsx)("option",{value:e,children:d("loops.days","{{value}} days",{value:e})},e))})})})]}),(0,i.jsxs)("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-12",children:[(0,i.jsx)("div",{className:"md:col-span-6",children:(0,i.jsx)(s.zB,{label:d("loops.includeKeywords","Include keywords"),hint:d("loops.includeKeywordsHint","Optional, will be appended to search query"),children:(0,i.jsx)(s.pd,{value:e.includeKeywords,onChange:a=>o({...e,includeKeywords:q(a.target.value)}),placeholder:d("loops.includeKeywordsPlaceholder","react typescript next"),disabled:r})})}),(0,i.jsx)("div",{className:"md:col-span-6",children:(0,i.jsx)(s.zB,{label:d("loops.excludeKeywords","Exclude keywords"),hint:d("loops.excludeKeywordsHint","Optional, will be appended as exclusions"),children:(0,i.jsx)(s.pd,{value:e.excludeKeywords,onChange:a=>o({...e,excludeKeywords:q(a.target.value)}),placeholder:d("loops.excludeKeywordsPlaceholder","senior lead manager zeitarbeit"),disabled:r})})})]}),(0,i.jsxs)("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-12",children:[(0,i.jsx)("div",{className:"md:col-span-3",children:(0,i.jsx)(s.zB,{label:d("loops.languageTitle","Language"),children:(0,i.jsx)("select",{value:e.language,onChange:a=>o({...e,language:a.target.value}),className:"h-10 w-full rounded-xl border border-border bg-card px-3 text-sm text-foreground",disabled:r,children:g.map(e=>(0,i.jsx)("option",{value:e.value,children:e.label},e.value))})})}),(0,i.jsx)("div",{className:"md:col-span-4 flex items-end",children:(0,i.jsxs)("label",{className:"flex items-center gap-2 text-sm text-foreground",children:[(0,i.jsx)("input",{type:"checkbox",checked:e.excludeAgencies,onChange:a=>o({...e,excludeAgencies:a.target.checked}),disabled:r}),d("loops.excludeAgencies","Exclude agencies / Zeitarbeit")]})}),(0,i.jsx)("div",{className:"md:col-span-5"})]}),(0,i.jsx)("div",{className:"text-xs text-muted-foreground",children:d("loops.advancedInfo","Advanced filters are stored in loop.filters. URL builders can be extended later per platform.")})]}):null]})}function P({open:e,onOpenChange:o,value:a,onChange:l,onApply:r,onReset:n,disabled:d}){const{t:c}=(0,t.Bd)();return(0,i.jsx)(s.aF,{open:e,onOpenChange:o,title:c("loops.myLoopSettings","My Loop settings"),description:c("loops.myLoopSettingsDescription","Update filters, click Apply to refresh links and save settings to your loop."),size:"lg",children:(0,i.jsx)(T,{value:a,onChange:l,onApply:r,onReset:n,disabled:d})})}var $=a(61239);function O({platform:e,url:o,isActive:a,onOpen:l,onAdd:r,addDisabled:n}){const{t:d}=(0,t.Bd)(),c=$.Jf[e]??e;return(0,i.jsx)("div",{className:["rounded-2xl border bg-background p-4 space-y-3",a?"border-primary/50 ring-1 ring-primary/30":"border-border"].join(" "),children:(0,i.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,i.jsxs)("div",{className:"min-w-0",children:[(0,i.jsx)("div",{className:"text-sm font-semibold text-foreground truncate",children:c}),(0,i.jsx)("div",{className:"text-xs text-muted-foreground truncate",children:o})]}),(0,i.jsxs)("div",{className:"flex items-center gap-2 shrink-0",children:[(0,i.jsx)(s.$n,{variant:"outline",shape:"lg",onClick:l,children:d("loops.open","Open")}),(0,i.jsx)(s.$n,{variant:"default",shape:"lg",shadow:"sm",onClick:r,disabled:n,children:d("loops.add","Add")})]})]})})}function K(e,o){const a=Object.keys(m.BV);for(const t of a)if(e[t]!==o[t])return!1;return!0}function F(e){return"string"==typeof e&&e.trim().length>0}function z(e,o){const a=e[o];return"string"==typeof a?a:""}function D(e,o){const a=e[o],t="number"==typeof a?a:Number(a);return Number.isFinite(t)?t:0}function U({loop:e,userId:o,page:a,onPageChange:l}){const{t:r}=(0,t.Bd)(),[d,c]=(0,p.mk)(),[u,b]=(0,n.useState)(!1),[j,w]=(0,n.useState)(!1),[N,M]=(0,n.useState)(!1),[k,L]=(0,n.useState)(void 0),C={id:e.id,titles:e.titles,location:e.location??null,radiusKm:e.radiusKm??null,platforms:e.platforms,remoteMode:e.remoteMode,filters:e.filters},{draftFilters:S,setDraftFilters:A,applyDraftFilters:V,resetFilters:R,appliedFilters:q,activeLink:T,setActive:$,links:U}=function(e){const o=(0,n.useMemo)(()=>function(e){const o=(()=>{if(!h(e))return{};const o=e.filters;return h(o)?o:e})();return{role:g(o.role,m.BV.role),location:g(o.location,m.BV.location),radiusKm:x(f(o.radiusKm,m.BV.radiusKm),[5,10,20,30,50,100],m.BV.radiusKm),workMode:x(o.workMode,["any","onsite","hybrid","remote","remote_only"],m.BV.workMode),seniority:x(o.seniority,["intern","junior","mid","senior","lead"],m.BV.seniority),employmentType:x(o.employmentType,["full_time","part_time","contract","internship","ausbildung"],m.BV.employmentType),postedWithin:x(f(o.postedWithin,m.BV.postedWithin),[1,3,7,14,30],m.BV.postedWithin),includeKeywords:g(o.includeKeywords,m.BV.includeKeywords),excludeKeywords:g(o.excludeKeywords,m.BV.excludeKeywords),excludeAgencies:(a=o.excludeAgencies,t=m.BV.excludeAgencies,"boolean"==typeof a?a:t),language:x(o.language,["any","de","en"],m.BV.language)};var a,t}(e),[e]),[a,t]=(0,n.useState)(()=>o),[l,r]=(0,n.useState)(()=>o),[s,i]=(0,n.useState)(null),[d,c]=(0,n.useState)(!1);(0,n.useEffect)(()=>{t(o),r(o),i(null),c(!1)},[e.id]),(0,n.useEffect)(()=>{d||(t(e=>K(e,o)?e:o),r(e=>K(e,o)?e:o),i(null))},[o,d]);const u=(0,n.useCallback)(e=>{t(e),c(!K(e,o))},[o]),p=(0,n.useMemo)(()=>{return function(e,o){return e.map(e=>({platform:e,url:(0,m.ad)(e,o)}))}(e.platforms,{role:[[(o=l).role,o.includeKeywords].filter(Boolean).join(" ").trim(),(o.excludeKeywords||"").split(/\s+/g).filter(Boolean).map(e=>e.startsWith("-")?e:`-${e}`).join(" ")].filter(Boolean).join(" ").trim(),location:o.location,radiusKm:Number(o.radiusKm),workMode:"remote_only"===o.workMode?"remote_only":"any"});var o},[e.platforms,l]),b=(0,n.useCallback)(()=>{t(o),r(o),i(null),c(!1)},[o]),v=(0,n.useCallback)(()=>{r(a),i(null),c(!1)},[a]),y=(0,n.useCallback)((e,o)=>{i({platform:e,url:o})},[]);return{draftFilters:a,setDraftFilters:u,appliedFilters:l,applyDraftFilters:v,resetFilters:b,activeLink:s,setActiveLink:i,setActive:y,links:p}}(C),E=c.isLoading,_=Boolean(o)&&!E,W=12,G=Math.max(1,Math.ceil(U.length/W)),Y=Math.max(1,Math.min(G,(0,v.hD)(a))),J=(Y-1)*W,H=(0,n.useMemo)(()=>0===U.length?{from:0,to:0}:{from:J+1,to:Math.min(U.length,J+W)},[U.length,J,W]),Z=(0,n.useMemo)(()=>U.slice(J,J+W),[U,J,W]),Q=(0,n.useMemo)(()=>{const e=[],o=z(q,"role").trim(),a=z(q,"location").trim(),t=D(q,"radiusKm"),l=function(e){const o=e.workMode;return"string"==typeof o?o:"any"}(q),s=D(q,"postedWithin");return F(o)&&e.push(r("loops.badgeRole","Role: {{value}}",{value:o})),F(a)&&e.push(r("loops.badgeLoc","Loc: {{value}}",{value:a})),e.push(r("loops.badgeRadius","Radius: {{value}}km",{value:t})),"any"!==l&&e.push(r("loops.badgeMode","Mode: {{value}}",{value:l})),e.push(r("loops.badgePosted","Posted: {{value}}d",{value:s})),e},[q,r]),X=e=>{L(e),M(!0)};return(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsx)(P,{open:j,onOpenChange:w,value:S,onChange:A,disabled:E,onApply:async()=>{var a;if(V(),l(1),o)try{await d({loopId:e.id,name:e.name,titles:(0,m.CP)(S.role),location:S.location,radiusKm:S.radiusKm,remoteMode:(a=S.workMode,"remote_only"===a?"remote_only":"any"),filters:S}).unwrap(),w(!1)}catch(e){console.error("Failed to save filters:",(0,y.u)(e))}},onReset:()=>{R(),l(1)}}),(0,i.jsxs)("div",{className:"rounded-2xl border border-border bg-card p-6 space-y-4",children:[(0,i.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,i.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,i.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,i.jsx)("h3",{className:"text-base font-semibold text-foreground",children:r("loops.searchLinksTitle","Search links")}),(0,i.jsx)("span",{className:"inline-flex items-center rounded-full border border-border bg-muted/40 px-2.5 py-0.5 text-xs font-medium text-muted-foreground",children:r("loops.showing","Showing {{from}}–{{to}} of {{total}}",{from:H.from,to:H.to,total:U.length})})]}),(0,i.jsx)("p",{className:"text-sm text-muted-foreground",children:r("loops.searchLinksSubtitle","Apply filters → open platform → pick a job → paste URL → save match.")}),Q.length?(0,i.jsx)("div",{className:"mt-2 flex flex-wrap gap-2",children:Q.map(e=>(0,i.jsx)("span",{className:"rounded-full border border-border bg-background px-3 py-1 text-xs text-muted-foreground",children:e},e))}):null]}),(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(s.$n,{variant:"outline",shape:"lg",onClick:()=>w(!0),disabled:E,children:r("loops.myLoopSettings","My Loop settings")}),(0,i.jsx)(s.$n,{variant:"outline",shape:"lg",onClick:()=>b(!0),disabled:!_,children:r("loops.editSources","Edit sources")}),(0,i.jsx)(s.$n,{variant:"default",shape:"lg",shadow:"sm",onClick:()=>X(void 0),disabled:!o,children:r("loops.addMatch","Add match")})]}),(0,i.jsx)(I,{open:u,onOpenChange:b,value:e.platforms,disabled:!_,onSave:async a=>{if(o)try{await d({loopId:e.id,platforms:a}).unwrap()}catch(e){console.error("Failed to update sources:",(0,y.u)(e))}}})]}),(0,i.jsx)("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:Z.map(e=>{const a=T?.platform===e.platform&&T?.url===e.url;return(0,i.jsx)(O,{platform:e.platform,url:e.url,isActive:a,onOpen:()=>{return o=e.platform,a=e.url,$(o,a),void function(e){window.open(e,"_blank","noopener,noreferrer")}(a);var o,a},onAdd:()=>X(e.platform),addDisabled:!o},`${e.platform}:${e.url}`)})}),(0,i.jsx)("div",{className:"flex items-center justify-center",children:(0,i.jsx)(s.dK,{page:Y,totalPages:G,onPageChange:l,disabled:E})}),(0,i.jsx)(B,{open:N,onOpenChange:M,loopId:e.id,defaultPlatform:k})]})]})}var E=a(40457),_=a(338);function W({userId:e,loopId:o,onBack:a}){const{t:r}=(0,t.Bd)(),m=(0,l.Zp)(),h=(0,l.zy)(),g=(0,u.j)(),f=(0,u.G)(e=>e.loopsUi.detailsPageByLoopId[o]),x=(e=>{try{const o=new URLSearchParams(e).get("page"),a=o?Number(o):NaN,t=Number.isFinite(a)?Math.trunc(a):NaN;return t>0?t:null}catch{return null}})(h.search),y=x??f??1;(0,n.useEffect)(()=>{null===x&&(0,_.N)(m,h,{page:String(y)},{replace:!0})},[x,y,m,h]),(0,n.useEffect)(()=>{g((0,E.cc)({loopId:o,page:y})),g((0,E.XU)(`${h.pathname}${h.search}`))},[g,o,y,h.pathname,h.search]);const j=(0,p.uB)({loopId:o}),w=j.data??null,N=(0,n.useMemo)(()=>w?.name??r("loops.detailsTitle","Loop"),[w?.name,r]),M=(0,n.useMemo)(()=>{if(!w)return r("loops.detailsHint","Change filters → Apply → links update and filters persist.");const e=b(w.titles)||r("loops.dash","—"),o="remote_only"===w.remoteMode?r("loops.remoteOnly","Remote"):r("loops.any","Any");return`${e} · ${w.location} · ${o}`},[w,r]),k=(0,n.useMemo)(()=>j.isLoading?(0,i.jsx)(c,{children:r("loops.loadingLoop","Loading loop…")}):j.isError?(0,i.jsx)(c,{children:(0,v.u1)(j.error)}):w?(0,i.jsx)(U,{userId:e,page:y,onPageChange:e=>{g((0,E.cc)({loopId:o,page:e})),(0,_.N)(m,h,{page:String(e)},{replace:!0})},loop:{id:w.id,name:w.name,titles:w.titles,location:w.location,radiusKm:w.radiusKm,platforms:w.platforms,remoteMode:w.remoteMode,filters:w.filters}}):(0,i.jsx)(c,{children:r("loops.notFound","Loop not found.")}),[j.isLoading,j.isError,j.error,w,r,e,y,g,o,m,h]);return(0,i.jsxs)("div",{className:"space-y-6",children:[(0,i.jsx)(d,{title:N,subtitle:M,right:(0,i.jsx)(s.$n,{variant:"outline",shape:"lg",onClick:a,children:r("loops.back","Back")})}),k]})}var G=a(29189),Y=a(73431);function J(e,o){const a=new URLSearchParams(e);a.set("page",String((0,v.hD)(o)));const t=a.toString();return t?`?${t}`:""}function H({userId:e,onOpenLoop:o}){const{t:a}=(0,t.Bd)(),r=(0,l.Zp)(),d=(0,l.zy)(),c=(0,u.j)(),m=(0,u.G)(e=>e.loopsUi.listPage),[h,g]=(0,n.useState)(!1),f=(0,n.useMemo)(()=>function(e){const o=new URLSearchParams(e).get("page");if(!o)return null;const a=Number(o);return(0,v.hD)(a)}(d.search)??(0,v.hD)(m),[d.search,m]),x=(0,n.useRef)({1:null}),[y,j]=(0,n.useState)(null),[w]=(0,p.s8)(),N=(0,n.useCallback)(async o=>{if(!e)return void j(null);if(o<=1)return x.current[1]=null,void j(null);const a=x.current;if(void 0===a[o]){void 0===a[1]&&(a[1]=null);for(let e=1;e<o&&void 0!==a[e];e+=1){const o=a[e]??null,t=await w({pageSize:7,cursorId:o}).unwrap();if(a[e+1]=t.nextCursor??null,!t.nextCursor)break}j(a[o]??null)}else j(a[o]??null)},[w,e]);(0,n.useEffect)(()=>{let e=!1;return(async()=>{try{await N(f)}catch{}})().catch(()=>{}),()=>{e=!0}},[f,N]);const M=(0,p.wB)(e?{pageSize:7,cursorId:y}:G.hT),k=M.data,L=(0,n.useMemo)(()=>k?.items??[],[k]),C=k?.total??0,S=M.data?.nextCursor??null,B=(0,n.useMemo)(()=>{const e=Math.ceil(C/7);return e<=0?1:e},[C]);(0,n.useEffect)(()=>{if(!M.data)return;const e=f+1,o=x.current;void 0===o[e]&&(o[e]=S)},[M.data,f,S]),(0,n.useEffect)(()=>{if(!M.data)return;const e=Math.max(1,Math.min(B,f));if(e!==f){const o=J(d.search,e);r({pathname:d.pathname,search:o},{replace:!0})}},[M.data,f,B,r,d.pathname,d.search]),(0,n.useEffect)(()=>{c((0,E.t0)(f)),c((0,E.XU)(`${d.pathname}${d.search}`))},[c,f,d.pathname,d.search]);const A=(0,n.useCallback)(async e=>{const o=(0,v.hD)(e);await N(o);const a=J(d.search,o);r({pathname:d.pathname,search:a},{replace:!1})},[r,d.pathname,d.search,N]),I=(0,n.useMemo)(()=>0===C?0:7*(f-1)+1,[f,C]),V=(0,n.useMemo)(()=>0===C?0:7*(f-1)+L.length,[f,C,L.length]),R=(0,n.useMemo)(()=>M.isLoading?(0,i.jsx)("div",{className:"text-sm text-muted-foreground",children:a("loops.loading","Loading…")}):M.isError?(0,i.jsx)("div",{className:"text-sm text-muted-foreground",children:(0,v.u1)(M.error)}):0===C?(0,i.jsx)("div",{className:"text-sm text-muted-foreground",children:a("loops.empty","No loops yet. Create your first loop.")}):(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsx)("div",{className:"space-y-3",children:L.map(e=>{const t=b(e.titles)||a("loops.dash","—"),l="remote_only"===e.remoteMode?a("loops.remoteOnly","Remote"):a("loops.any","Any");return(0,i.jsxs)("div",{tabIndex:0,onClick:()=>o(e.id),onKeyDown:a=>{"Enter"!==a.key&&" "!==a.key||(a.preventDefault(),o(e.id))},className:["w-full","rounded-xl border border-border bg-background","px-4 py-4","hover:bg-muted transition-colors","focus:outline-none focus:ring-2 focus:ring-border","cursor-pointer","select-none"].join(" "),children:[(0,i.jsx)("div",{className:"text-sm font-semibold text-foreground",children:e.name}),(0,i.jsxs)("div",{className:"mt-1 text-xs text-muted-foreground",children:[e.location," · ",t," · ",l]})]},e.id)})}),(0,i.jsxs)("div",{className:"grid grid-cols-3 items-center",children:[(0,i.jsx)("div",{className:"text-xs text-muted-foreground",children:a("loops.showing","Showing {{from}}–{{to}} of {{total}}",{from:I,to:V,total:C})}),(0,i.jsx)(s.dK,{page:f,totalPages:B,onPageChange:A,disabled:M.isFetching,siblingCount:1})]})]}),[M.isLoading,M.isError,M.error,M.isFetching,L,o,f,I,V,a,C,B,A]);return(0,i.jsxs)("div",{className:"space-y-6",children:[(0,i.jsx)(s.zY,{title:a("loops.listTitle","My Loops"),subtitle:a("loops.listSubtitle","Create a loop and track matches."),right:(0,i.jsx)(s.$n,{variant:"default",shadow:"sm",shape:"lg",onClick:()=>g(!0),children:a("loops.newLoop","New loop")})}),(0,i.jsx)("div",{className:"rounded-2xl border border-border bg-card p-6",children:R}),(0,i.jsx)(Y.Wk,{open:h,onOpenChange:g,onCreated:e=>{x.current={1:null},j(null);const a=J(d.search,1);r({pathname:d.pathname,search:a},{replace:!0}),o(e)}})]})}function Z(){const{t:e}=(0,t.Bd)(),{userId:o}=(0,r.gv)(),a=(0,l.Zp)(),n=(0,l.zy)(),{loopId:u}=(0,l.g)(),p=Boolean(u),m=()=>a(`/dashboard/loops${n.search}`);return o?p?(0,i.jsx)(W,{userId:o,loopId:u,onBack:m}):(0,i.jsx)(H,{userId:o,onOpenLoop:e=>a(`/dashboard/loops/${e}${n.search}`)}):(0,i.jsxs)("div",{className:"space-y-6",children:[(0,i.jsx)(d,{title:p?e("loops.detailsTitle","Loop"):e("loops.listTitle","My Loops"),subtitle:e("loops.signInSubtitle","Sign in to continue."),right:p?(0,i.jsx)(s.$n,{variant:"outline",shape:"lg",onClick:m,children:e("loops.back","Back")}):null}),(0,i.jsx)(c,{children:e("loops.signInBody","Please sign in to view your loops.")})]})}},65546(e,o,a){a(24589),a(80784)}}]);
//# sourceMappingURL=4012.f935b173.chunk.js.map